import{_ as x}from"./index.Cw0fWXUa.js";import{k as g,c as y,o as n,b as u,q as P,w as t,r as d,a as N,z as U,B as O,p as r,F as S,s as p,j as V,t as k}from"./chunk-vendors.c9FUtYPc.js";const G={props:{ociCfgId:String,username:String,vcnId:String,vcnName:String},mounted(){this.getSecurityRuleList()},data(){return{total:0,batchSelected:[],loading:!0,addIngressLoading:!1,addEgressLoading:!1,inboundDialogVisible:!1,outboundDialogVisible:!1,inboundRule:{isStateless:!1,sourceType:"",source:"",protocol:"",icmpOptions:{code:"",type:""},sourcePort:"",destinationPort:"",description:""},outboundRule:{isStateless:!1,destinationType:"",destination:"",protocol:"",icmpOptions:{code:"",type:""},sourcePort:"",destinationPort:"",description:""},ruleList:[{id:"",isStateless:!1,protocol:"",sourceOrDestination:"",sourcePort:"",destinationPort:"",typeAndCode:"",description:""}],GetSecurityRuleListPageParams:{keyword:"",currentPage:1,pageSize:10,cleanReLaunch:!1,ociCfgId:"",vcnId:"",type:0},RemoveSecurityRuleParams:{ociCfgId:"",vcnId:"",type:0,ruleIds:[]},protocols:[{label:"所有协议",value:"all"},{label:"ICMP",value:"1"},{label:"TCP",value:"6"},{label:"UDP",value:"17"},{label:"3PC",value:"34"},{label:"A/N",value:"107"},{label:"AH",value:"51"},{label:"ARGUS",value:"13"},{label:"ARIS",value:"104"},{label:"AX.25",value:"93"},{label:"任意 0 跃点协议",value:"114"},{label:"任何分布式文件系统",value:"68"},{label:"任何主机内部协议",value:"61"},{label:"任何本地网络",value:"63"},{label:"任何专用加密方案",value:"99"},{label:"BBN-RCC-MON",value:"10"},{label:"BNA",value:"49"},{label:"BR-SAT-MON",value:"76"},{label:"CBT",value:"7"},{label:"CFTP",value:"62"},{label:"CHAOS",value:"16"},{label:"CPHB",value:"73"},{label:"CPNX",value:"72"},{label:"CRTP",value:"126"},{label:"CRUDP",value:"127"},{label:"Compaq-Peer",value:"110"},{label:"DCCP",value:"33"},{label:"DCN-MEAS",value:"19"},{label:"DDP",value:"37"},{label:"DDX",value:"116"},{label:"DGP",value:"86"},{label:"EGP",value:"8"},{label:"EIGRP",value:"88"},{label:"EMCON",value:"14"},{label:"ENCAP",value:"98"},{label:"ESP",value:"50"},{label:"ETHERIP",value:"97"},{label:"FC",value:"133"},{label:"FIRE",value:"125"},{label:"GGP",value:"3"},{label:"GMTP",value:"100"},{label:"GRE",value:"47"},{label:"HIP",value:"139"},{label:"HMP",value:"20"},{label:"HOPOPT",value:"0"},{label:"I-NLSP",value:"52"},{label:"IATP",value:"117"},{label:"IDPR",value:"35"},{label:"IDPR-CMTP",value:"38"},{label:"IDRP",value:"45"},{label:"IFMP",value:"101"},{label:"IGMP",value:"2"},{label:"IGP",value:"9"},{label:"IL",value:"40"},{label:"IP-in-IP",value:"4"},{label:"IPCU",value:"71"},{label:"IPComp",value:"108"},{label:"IPIP",value:"94"},{label:"IPLT",value:"129"},{label:"IPPC",value:"67"},{label:"IPX-in-IP",value:"111"},{label:"IPv6",value:"41"},{label:"IPv6-Frag",value:"44"},{label:"IPv6-ICMP",value:"58"},{label:"IPv6-NoNxt",value:"59"},{label:"IPv6-Opts",value:"60"},{label:"IPv6-Route",value:"43"},{label:"IRTP",value:"28"},{label:"IS-IS",value:"124"},{label:"ISO-IP",value:"80"},{label:"ISO-TP4",value:"29"},{label:"KRYPTOLAN",value:"65"},{label:"L2TP",value:"115"},{label:"LARP",value:"91"},{label:"LEAF-1",value:"25"},{label:"LEAF-2",value:"26"},{label:"Manet",value:"138"},{label:"MERIT-INP",value:"32"},{label:"MFE-NSP",value:"31"},{label:"MHRP",value:"48"},{label:"MICP",value:"95"},{label:"MOBILE",value:"55"},{label:"MPLS-in-IP",value:"137"},{label:"MTP",value:"92"},{label:"MUX",value:"18"},{label:"Mobility",value:"135"},{label:"NARP",value:"54"},{label:"NETBLT",value:"30"},{label:"NSFNET-IGP",value:"85"},{label:"NVP-II",value:"11"},{label:"OSPF",value:"89"},{label:"PGM",value:"113"},{label:"PIM",value:"103"},{label:"PIPE",value:"131"},{label:"PNNI",value:"102"},{label:"PRM",value:"21"},{label:"PTP",value:"123"},{label:"PUP",value:"12"},{label:"PVP",value:"75"},{label:"QNX",value:"106"},{label:"可靠的数据协议",value:"27"},{label:"ROHC",value:"142"},{label:"RSVP",value:"46"},{label:"RSVP-E2E-IGNORE",value:"134"},{label:"RVD",value:"66"},{label:"SAT-EXPAK",value:"64"},{label:"SAT-MON",value:"69"},{label:"SCC-SP",value:"96"},{label:"SCPS",value:"105"},{label:"SCTP",value:"132"},{label:"SDRP",value:"42"},{label:"SECURE-VMTP",value:"82"},{label:"SKIP",value:"57"},{label:"SM",value:"122"},{label:"SMP",value:"121"},{label:"SNP",value:"109"},{label:"SPS",value:"130"},{label:"SRP",value:"119"},{label:"SSCOPMCE",value:"128"},{label:"ST",value:"5"},{label:"STP",value:"118"},{label:"SUN-ND",value:"77"},{label:"SWIPE",value:"53"},{label:"Shim6",value:"140"},{label:"Sprite-RPC",value:"90"},{label:"TCF",value:"87"},{label:"TLSP",value:"56"},{label:"TP++",value:"39"},{label:"TRUNK-1",value:"23"},{label:"TRUNK-2",value:"24"},{label:"TTP/IPTM",value:"84"},{label:"UDPLite",value:"136"}]}},methods:{async reloadSecurityRuleList(){this.GetSecurityRuleListPageParams.cleanReLaunch=!0,this.loading=!0,this.getSecurityRuleList(),this.GetSecurityRuleListPageParams.cleanReLaunch=!1},async getSecurityRuleList(){this.loading=!0,this.GetSecurityRuleListPageParams.ociCfgId=this.ociCfgId,this.GetSecurityRuleListPageParams.vcnId=this.vcnId,await this.$axios.post("/securityRule/page",{...this.GetSecurityRuleListPageParams}).then(o=>{o.data.success?(this.ruleList=o.data.data.records,this.total=o.data.data.total):g({message:o.data.msg,type:"error",duration:2e3}),this.loading=!1}).catch(o=>{console.error("Error:",o)}).finally(()=>{this.batchSelected=[]})},handleRemove(o){this.batchSelected.push(o),this.batchRemove()},async batchRemove(){if(!window.confirm("确定要删除安全规则吗")){this.$message.info("已取消");return}this.loading=!0,this.RemoveSecurityRuleParams.ociCfgId=this.ociCfgId,this.RemoveSecurityRuleParams.vcnId=this.vcnId,this.RemoveSecurityRuleParams.type=this.GetSecurityRuleListPageParams.type,this.RemoveSecurityRuleParams.ruleIds=this.batchSelected.map(e=>e.id),await this.$axios.post("/securityRule/remove",{...this.RemoveSecurityRuleParams}).then(e=>{e.data.success?(g({message:"删除规则成功",type:"success",duration:2e3}),this.reloadSecurityRuleList(),this.batchSelected=[],this.RemoveSecurityRuleParams.ruleIds=[]):g({message:e.data.msg,type:"error",duration:2e3})}).catch(e=>{console.error("Error:",e)})},async addInboundRule(){this.addIngressLoading=!0,await this.$axios.post("/securityRule/addIngress",{ociCfgId:this.ociCfgId,vcnId:this.vcnId,inboundRule:this.inboundRule}).then(o=>{o.data.success?(g({message:"添加入站规则成功",type:"success",duration:2e3}),this.inboundDialogVisible=!1,this.reloadSecurityRuleList()):g({message:o.data.msg,type:"error",duration:2e3})}).catch(o=>{console.error("Error:",o)}).finally(()=>{this.addIngressLoading=!1})},async addOutboundRule(){this.addEgressLoading=!0,await this.$axios.post("/securityRule/addEgress",{ociCfgId:this.ociCfgId,vcnId:this.vcnId,outboundRule:this.outboundRule}).then(o=>{o.data.success?(g({message:"添加出站规则成功",type:"success",duration:2e3}),this.outboundDialogVisible=!1,this.reloadSecurityRuleList()):g({message:o.data.msg,type:"error",duration:2e3})}).catch(o=>{console.error("Error:",o)}).finally(()=>{this.addEgressLoading=!1})},handlePageChange(o){this.GetSecurityRuleListPageParams.currentPage=o,this.getSecurityRuleList()},handleSizeChange(o){this.GetSecurityRuleListPageParams.currentPage=1,this.GetSecurityRuleListPageParams.pageSize=o,this.getSecurityRuleList()},handleSelectionChange(o){this.batchSelected=o}}},M={key:0},w={style:{"overflow-x":"auto"}};function _(o,e,A,B,l,b){const v=d("el-button"),I=d("el-switch"),i=d("el-form-item"),R=d("el-option"),c=d("el-select"),s=d("el-input"),f=d("el-form"),C=d("el-dialog"),h=d("el-divider"),m=d("el-table-column"),L=d("el-tag"),D=d("el-table"),T=d("el-pagination"),E=O("loading");return n(),y(S,null,[u(v,{type:"primary",onClick:e[0]||(e[0]=a=>l.inboundDialogVisible=!0)},{default:t(()=>e[28]||(e[28]=[p("添加入站规则")])),_:1}),u(C,{modelValue:l.inboundDialogVisible,"onUpdate:modelValue":e[11]||(e[11]=a=>l.inboundDialogVisible=a),title:"添加入站规则",width:"50%"},{footer:t(()=>[u(v,{onClick:e[10]||(e[10]=a=>l.inboundDialogVisible=!1)},{default:t(()=>e[29]||(e[29]=[p("取消")])),_:1}),u(v,{type:"primary",onClick:b.addInboundRule,loading:l.addIngressLoading},{default:t(()=>e[30]||(e[30]=[p("添加入站规则")])),_:1},8,["onClick","loading"])]),default:t(()=>[u(f,{"label-width":"120px"},{default:t(()=>[u(i,{label:"无状态"},{default:t(()=>[u(I,{modelValue:l.inboundRule.isStateless,"onUpdate:modelValue":e[1]||(e[1]=a=>l.inboundRule.isStateless=a),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1}),u(i,{label:"源类型"},{default:t(()=>[u(c,{modelValue:l.inboundRule.sourceType,"onUpdate:modelValue":e[2]||(e[2]=a=>l.inboundRule.sourceType=a),placeholder:"请选择"},{default:t(()=>[u(R,{label:"CIDR",value:"CIDR_BLOCK"}),u(R,{label:"服务",value:"SERVICE_CIDR_BLOCK"})]),_:1},8,["modelValue"])]),_:1}),u(i,{label:"源 CIDR"},{default:t(()=>[u(s,{modelValue:l.inboundRule.source,"onUpdate:modelValue":e[3]||(e[3]=a=>l.inboundRule.source=a),placeholder:"请输入 CIDR，如 10.0.0.0/24"},null,8,["modelValue"])]),_:1}),u(i,{label:"IP 协议"},{default:t(()=>[u(c,{modelValue:l.inboundRule.protocol,"onUpdate:modelValue":e[4]||(e[4]=a=>l.inboundRule.protocol=a),placeholder:"请选择"},{default:t(()=>[(n(!0),y(S,null,V(l.protocols,a=>(n(),r(R,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l.inboundRule.protocol==="1"?(n(),r(i,{key:0,label:"类型"},{default:t(()=>[u(s,{modelValue:l.inboundRule.icmpOptions.type,"onUpdate:modelValue":e[5]||(e[5]=a=>l.inboundRule.icmpOptions.type=a),placeholder:"全部"},null,8,["modelValue"])]),_:1})):P("",!0),l.inboundRule.protocol==="1"?(n(),r(i,{key:1,label:"代码"},{default:t(()=>[u(s,{modelValue:l.inboundRule.icmpOptions.code,"onUpdate:modelValue":e[6]||(e[6]=a=>l.inboundRule.icmpOptions.code=a),placeholder:"全部"},null,8,["modelValue"])]),_:1})):P("",!0),["6","17"].includes(l.inboundRule.protocol)?(n(),r(i,{key:2,label:"源端口范围"},{default:t(()=>[u(s,{modelValue:l.inboundRule.sourcePort,"onUpdate:modelValue":e[7]||(e[7]=a=>l.inboundRule.sourcePort=a),placeholder:"示例: 80、20-22"},null,8,["modelValue"])]),_:1})):P("",!0),["6","17"].includes(l.inboundRule.protocol)?(n(),r(i,{key:3,label:"目标端口范围"},{default:t(()=>[u(s,{modelValue:l.inboundRule.destinationPort,"onUpdate:modelValue":e[8]||(e[8]=a=>l.inboundRule.destinationPort=a),placeholder:"示例: 80、20-22"},null,8,["modelValue"])]),_:1})):P("",!0),u(i,{label:"说明"},{default:t(()=>[u(s,{modelValue:l.inboundRule.description,"onUpdate:modelValue":e[9]||(e[9]=a=>l.inboundRule.description=a),type:"textarea",maxlength:"255","show-word-limit":"",placeholder:"最多 255 个字符"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),u(v,{type:"primary",onClick:e[12]||(e[12]=a=>l.outboundDialogVisible=!0)},{default:t(()=>e[31]||(e[31]=[p("添加出站规则")])),_:1}),u(C,{modelValue:l.outboundDialogVisible,"onUpdate:modelValue":e[23]||(e[23]=a=>l.outboundDialogVisible=a),title:"添加出站规则",width:"50%"},{footer:t(()=>[u(v,{onClick:e[22]||(e[22]=a=>l.outboundDialogVisible=!1)},{default:t(()=>e[32]||(e[32]=[p("取消")])),_:1}),u(v,{type:"primary",onClick:b.addOutboundRule,loading:l.addEgressLoading},{default:t(()=>e[33]||(e[33]=[p("添加出站规则")])),_:1},8,["onClick","loading"])]),default:t(()=>[u(f,{"label-width":"120px"},{default:t(()=>[u(i,{label:"无状态"},{default:t(()=>[u(I,{modelValue:l.outboundRule.isStateless,"onUpdate:modelValue":e[13]||(e[13]=a=>l.outboundRule.isStateless=a),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1}),u(i,{label:"目的地类型"},{default:t(()=>[u(c,{modelValue:l.outboundRule.destinationType,"onUpdate:modelValue":e[14]||(e[14]=a=>l.outboundRule.destinationType=a),placeholder:"请选择"},{default:t(()=>[u(R,{label:"CIDR",value:"CIDR_BLOCK"}),u(R,{label:"服务",value:"SERVICE_CIDR_BLOCK"})]),_:1},8,["modelValue"])]),_:1}),u(i,{label:"目的地 CIDR"},{default:t(()=>[u(s,{modelValue:l.outboundRule.destination,"onUpdate:modelValue":e[15]||(e[15]=a=>l.outboundRule.destination=a),placeholder:"请输入 CIDR，如 10.0.0.0/24"},null,8,["modelValue"])]),_:1}),u(i,{label:"IP 协议"},{default:t(()=>[u(c,{modelValue:l.outboundRule.protocol,"onUpdate:modelValue":e[16]||(e[16]=a=>l.outboundRule.protocol=a),placeholder:"请选择"},{default:t(()=>[(n(!0),y(S,null,V(l.protocols,a=>(n(),r(R,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l.outboundRule.protocol==="1"?(n(),r(i,{key:0,label:"类型"},{default:t(()=>[u(s,{modelValue:l.outboundRule.icmpOptions.type,"onUpdate:modelValue":e[17]||(e[17]=a=>l.outboundRule.icmpOptions.type=a),placeholder:"全部"},null,8,["modelValue"])]),_:1})):P("",!0),l.outboundRule.protocol==="1"?(n(),r(i,{key:1,label:"代码"},{default:t(()=>[u(s,{modelValue:l.outboundRule.icmpOptions.code,"onUpdate:modelValue":e[18]||(e[18]=a=>l.outboundRule.icmpOptions.code=a),placeholder:"全部"},null,8,["modelValue"])]),_:1})):P("",!0),["6","17"].includes(l.outboundRule.protocol)?(n(),r(i,{key:2,label:"源端口范围"},{default:t(()=>[u(s,{modelValue:l.outboundRule.sourcePort,"onUpdate:modelValue":e[19]||(e[19]=a=>l.outboundRule.sourcePort=a),placeholder:"示例: 80、20-22"},null,8,["modelValue"])]),_:1})):P("",!0),["6","17"].includes(l.outboundRule.protocol)?(n(),r(i,{key:3,label:"目标端口范围"},{default:t(()=>[u(s,{modelValue:l.outboundRule.destinationPort,"onUpdate:modelValue":e[20]||(e[20]=a=>l.outboundRule.destinationPort=a),placeholder:"示例: 80、20-22"},null,8,["modelValue"])]),_:1})):P("",!0),u(i,{label:"说明"},{default:t(()=>[u(s,{modelValue:l.outboundRule.description,"onUpdate:modelValue":e[21]||(e[21]=a=>l.outboundRule.description=a),type:"textarea",maxlength:"255","show-word-limit":"",placeholder:"最多 255 个字符"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),u(h,{class:"divider"}),o.showSecurityRuleList?P("",!0):(n(),y("div",M,[u(v,{type:"success",style:{"margin-bottom":"20px"},onClick:b.reloadSecurityRuleList},{default:t(()=>e[34]||(e[34]=[p(" 刷新 ")])),_:1},8,["onClick"]),u(s,{modelValue:l.GetSecurityRuleListPageParams.keyword,"onUpdate:modelValue":e[24]||(e[24]=a=>l.GetSecurityRuleListPageParams.keyword=a),placeholder:"模糊搜索",onInput:b.getSecurityRuleList,clearable:"","prefix-icon":"Search",style:{"margin-left":"20px",width:"200px","margin-bottom":"20px"}},null,8,["modelValue","onInput"]),u(c,{modelValue:l.GetSecurityRuleListPageParams.type,"onUpdate:modelValue":e[25]||(e[25]=a=>l.GetSecurityRuleListPageParams.type=a),onChange:b.getSecurityRuleList,placeholder:"开机任务状态筛选",style:{"margin-left":"20px",width:"180px","margin-bottom":"20px"}},{default:t(()=>[u(R,{label:"入站规则",value:0}),u(R,{label:"出站规则",value:1})]),_:1},8,["modelValue","onChange"]),u(v,{type:"danger",onClick:b.batchRemove,disabled:!l.batchSelected.length,style:{"margin-left":"20px","margin-bottom":"20px"}},{default:t(()=>e[35]||(e[35]=[p(" 批量删除 ")])),_:1},8,["onClick","disabled"]),N("div",w,[U((n(),r(D,{data:l.ruleList,style:{width:"100%","min-width":"800px"},onSelectionChange:b.handleSelectionChange},{default:t(()=>[u(m,{type:"selection",width:"35"}),u(m,{fixed:"",prop:"isStateless",label:"无状态"}),u(m,{label:"源"},{default:t(({row:a})=>[u(L,{type:"primary"},{default:t(()=>[p(k(a.sourceOrDestination),1)]),_:2},1024)]),_:1}),u(m,{prop:"protocol",label:"协议"}),u(m,{prop:"sourcePort",label:"源端口范围"}),u(m,{prop:"destinationPort",label:"目的地端口范围"}),u(m,{prop:"typeAndCode",label:"类型和代码"}),u(m,{prop:"description",label:"说明"}),u(m,{fixed:"right",label:"操作",width:"150"},{default:t(({row:a})=>[u(v,{onClick:z=>b.handleRemove(a),type:"danger",link:""},{default:t(()=>e[36]||(e[36]=[p(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSelectionChange"])),[[E,l.loading]])]),u(T,{onCurrentChange:b.handlePageChange,onSizeChange:b.handleSizeChange,"current-page":l.GetSecurityRuleListPageParams.currentPage,"onUpdate:currentPage":e[26]||(e[26]=a=>l.GetSecurityRuleListPageParams.currentPage=a),"page-size":l.GetSecurityRuleListPageParams.pageSize,"onUpdate:pageSize":e[27]||(e[27]=a=>l.GetSecurityRuleListPageParams.pageSize=a),"page-sizes":[5,10,20,50],total:l.total,layout:"total, sizes, prev, pager, next, jumper",style:{"margin-top":"20px"}},null,8,["onCurrentChange","onSizeChange","current-page","page-size","total"])]))],64)}const K=x(G,[["render",_]]);export{K as default};
