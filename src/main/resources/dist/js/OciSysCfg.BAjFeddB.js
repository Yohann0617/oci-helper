import{K as Q,M as J,N as q,O as Z,P as W,Q as G,R as X,S as H,T as Y,j as u,c as V,b as a,w as t,r as s,o as b,a as r,q as d,m as A,p as I,B as $,x as O,y as ee,t as v,z as E,F as N}from"./chunk-vendors.CdTauPKY.js";import{_ as B}from"./index.C40PP_gZ.js";import{a as L,c as ae}from"./common.CZhk_xKy.js";import te from"./IpDataView.BzpdVJVr.js";const le={components:{ChatDotRound:Y,Bell:H,Notification:X,Calendar:G,ChatLineRound:W,MessageBox:Z,Lock:q,Promotion:J,Key:Q},data(){return{loadingStates:{telegram:!1,ding:!1,dailyBroadcast:!1,ai:!1,bootBroadcast:!1},sendLoading:!1,sendMfaCodeLoading:!1,UpdateSysCfgParams:{dingToken:"",dingSecret:"",tgChatId:"",tgBotToken:"",enableMfa:!1,mfaSecret:"",mfaQrData:"",enableDailyBroadcast:!0,dailyBroadcastCron:"",enableVersionInform:!0,gjAiApi:"",bootBroadcastToken:""},message:"",mfaCode:""}},mounted(){this.getSysCfg()},methods:{async getSysCfg(){await this.$axios.post("/sys/getSysCfg",{}).then(o=>{if(o.data.success){const e=o.data.data;console.log("Backend data received:",e),this.UpdateSysCfgParams={dingToken:e.dingToken||"",dingSecret:e.dingSecret||"",tgChatId:e.tgChatId||"",tgBotToken:e.tgBotToken||"",enableMfa:e.enableMfa||!1,mfaSecret:e.mfaSecret||"",mfaQrData:e.mfaQrData||"",enableDailyBroadcast:e.enableDailyBroadcast!==void 0?e.enableDailyBroadcast:!0,dailyBroadcastCron:e.dailyBroadcastCron||"",enableVersionInform:e.enableVersionInform!==void 0?e.enableVersionInform:!0,gjAiApi:e.gjAiApi||"",bootBroadcastToken:e.bootBroadcastToken||""},console.log("Updated params:",this.UpdateSysCfgParams)}else u({message:o.data.msg,type:"error",duration:2e3})}).catch(o=>{console.error("Error:",o),u({message:"获取配置失败",type:"error",duration:2e3})})},async saveTelegramConfig(){this.loadingStates.telegram=!0,await this.updateSysCfg(),this.loadingStates.telegram=!1},async saveDingConfig(){this.loadingStates.ding=!0,await this.updateSysCfg(),this.loadingStates.ding=!1},async saveVersionInformConfig(){await this.updateSysCfg()},async saveDailyBroadcastConfig(){this.loadingStates.dailyBroadcast=!0,await this.updateSysCfg(),this.loadingStates.dailyBroadcast=!1},async saveAiConfig(){this.loadingStates.ai=!0,await this.updateSysCfg(),this.loadingStates.ai=!1},async saveBootBroadcastConfig(){this.loadingStates.bootBroadcast=!0,await this.updateSysCfg(),this.loadingStates.bootBroadcast=!1},async saveMfaConfig(){await this.updateSysCfg()},async updateSysCfg(){await this.$axios.post("/sys/updateSysCfg",{...this.UpdateSysCfgParams}).then(o=>{o.data.success?(u({message:o.data.msg,type:"success",duration:2e3}),this.getSysCfg()):u({message:o.data.msg,type:"error",duration:2e3})}).catch(o=>{console.error("Error:",o),u({message:"保存配置失败",type:"error",duration:2e3})})},async sendMsg(){this.sendLoading=!0,await this.$axios.post("/sys/sendMsg",{message:this.message}).then(o=>{o.data.success?u({message:o.data.msg,type:"success",duration:2e3}):u({message:o.data.msg,type:"error",duration:2e3})}).catch(o=>{console.error("Error:",o)}),this.sendLoading=!1},async checkMfaCode(){this.sendMfaCodeLoading=!0,await this.$axios.post("/sys/checkMfaCode",{mfaCode:this.mfaCode}).then(o=>{o.data.success?u({message:o.data.msg,type:"success",duration:2e3}):u({message:o.data.msg,type:"error",duration:2e3})}).catch(o=>{console.error("Error:",o)}),this.sendMfaCodeLoading=!1}}},oe={class:"config-container"},se={class:"config-section"},ne={class:"card-header"},de={class:"header-left"},ie={class:"card-header"},re={class:"header-left"},pe={class:"card-header"},fe={class:"header-left"},ce={class:"card-header"},me={class:"header-left"},ue={class:"card-header"},ge={class:"header-left"},Ce={class:"card-header"},he={class:"header-left"},ye={class:"card-header"},_e={class:"header-left"},be={key:1,class:"mfa-preview"},De={class:"test-section"},Pe={class:"card-header"},ve={class:"header-left"},ke={class:"button-group"},Se={class:"card-header"},Re={class:"header-left"},Ve={class:"button-group"};function we(o,e,S,U,l,p){const C=s("ChatDotRound"),m=s("el-icon"),c=s("el-button"),g=s("el-input"),h=s("el-form-item"),D=s("el-form"),k=s("el-card"),w=s("Bell"),P=s("Notification"),R=s("el-switch"),y=s("Calendar"),f=s("ChatLineRound"),i=s("el-link"),x=s("el-alert"),T=s("MessageBox"),M=s("Lock"),n=s("el-image"),z=s("el-col"),F=s("Promotion"),j=s("Key"),K=s("el-row");return b(),V("div",oe,[a(K,{gutter:20},{default:t(()=>[a(z,{xs:24,sm:24,md:14,lg:14},{default:t(()=>[r("div",se,[a(k,{shadow:"hover",class:"config-card"},{header:t(()=>[r("div",ne,[r("div",de,[a(m,{class:"header-icon",color:"#409EFF"},{default:t(()=>[a(C)]),_:1}),e[13]||(e[13]=r("span",{class:"card-title"},"Telegram 配置",-1))]),a(c,{type:"primary",size:"small",onClick:p.saveTelegramConfig,loading:l.loadingStates.telegram,icon:o.Select},{default:t(()=>e[14]||(e[14]=[d(" 保存 ")])),_:1},8,["onClick","loading","icon"])])]),default:t(()=>[a(D,{"label-position":"top"},{default:t(()=>[a(h,{label:"机器人 Token"},{default:t(()=>[a(g,{modelValue:l.UpdateSysCfgParams.tgBotToken,"onUpdate:modelValue":e[0]||(e[0]=_=>l.UpdateSysCfgParams.tgBotToken=_),placeholder:"请输入 Telegram Bot Token",clearable:"",type:"password","show-password":"",autocomplete:"new-password"},null,8,["modelValue"])]),_:1}),a(h,{label:"个人 ID"},{default:t(()=>[a(g,{modelValue:l.UpdateSysCfgParams.tgChatId,"onUpdate:modelValue":e[1]||(e[1]=_=>l.UpdateSysCfgParams.tgChatId=_),placeholder:"请输入 Telegram 个人 ID",clearable:"",type:"password","show-password":"",autocomplete:"new-password"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(k,{shadow:"hover",class:"config-card"},{header:t(()=>[r("div",ie,[r("div",re,[a(m,{class:"header-icon",color:"#67C23A"},{default:t(()=>[a(w)]),_:1}),e[15]||(e[15]=r("span",{class:"card-title"},"钉钉配置",-1))]),a(c,{type:"primary",size:"small",onClick:p.saveDingConfig,loading:l.loadingStates.ding,icon:o.Select},{default:t(()=>e[16]||(e[16]=[d(" 保存 ")])),_:1},8,["onClick","loading","icon"])])]),default:t(()=>[a(D,{"label-position":"top"},{default:t(()=>[a(h,{label:"Access Token"},{default:t(()=>[a(g,{modelValue:l.UpdateSysCfgParams.dingToken,"onUpdate:modelValue":e[2]||(e[2]=_=>l.UpdateSysCfgParams.dingToken=_),placeholder:"请输入钉钉 Access Token",clearable:"",type:"password","show-password":"",autocomplete:"new-password"},null,8,["modelValue"])]),_:1}),a(h,{label:"Secret"},{default:t(()=>[a(g,{modelValue:l.UpdateSysCfgParams.dingSecret,"onUpdate:modelValue":e[3]||(e[3]=_=>l.UpdateSysCfgParams.dingSecret=_),placeholder:"请输入钉钉 Secret",clearable:"",type:"password","show-password":"",autocomplete:"new-password"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(k,{shadow:"hover",class:"config-card"},{header:t(()=>[r("div",pe,[r("div",fe,[a(m,{class:"header-icon",color:"#E6A23C"},{default:t(()=>[a(P)]),_:1}),e[17]||(e[17]=r("span",{class:"card-title"},"版本更新通知配置",-1))])])]),default:t(()=>[a(D,{"label-position":"top"},{default:t(()=>[a(h,{label:"是否启用版本更新通知"},{default:t(()=>[a(R,{modelValue:l.UpdateSysCfgParams.enableVersionInform,"onUpdate:modelValue":e[4]||(e[4]=_=>l.UpdateSysCfgParams.enableVersionInform=_),"active-text":"启用","inactive-text":"禁用",onChange:p.saveVersionInformConfig},null,8,["modelValue","onChange"])]),_:1})]),_:1})]),_:1}),a(k,{shadow:"hover",class:"config-card"},{header:t(()=>[r("div",ce,[r("div",me,[a(m,{class:"header-icon",color:"#409EFF"},{default:t(()=>[a(y)]),_:1}),e[18]||(e[18]=r("span",{class:"card-title"},"每日播报配置",-1))]),a(c,{type:"primary",size:"small",onClick:p.saveDailyBroadcastConfig,loading:l.loadingStates.dailyBroadcast,icon:o.Select},{default:t(()=>e[19]||(e[19]=[d(" 保存 ")])),_:1},8,["onClick","loading","icon"])])]),default:t(()=>[a(D,{"label-position":"top"},{default:t(()=>[a(h,{label:"是否启用每日播报"},{default:t(()=>[a(R,{modelValue:l.UpdateSysCfgParams.enableDailyBroadcast,"onUpdate:modelValue":e[5]||(e[5]=_=>l.UpdateSysCfgParams.enableDailyBroadcast=_),"active-text":"启用","inactive-text":"禁用",onChange:p.saveDailyBroadcastConfig},null,8,["modelValue","onChange"])]),_:1}),a(h,{label:"定时任务cron表达式"},{default:t(()=>[a(g,{modelValue:l.UpdateSysCfgParams.dailyBroadcastCron,"onUpdate:modelValue":e[6]||(e[6]=_=>l.UpdateSysCfgParams.dailyBroadcastCron=_),placeholder:"例（每天早晨9点30分0秒）：0 30 9 * * ?",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(k,{shadow:"hover",class:"config-card"},{header:t(()=>[r("div",ue,[r("div",ge,[a(m,{class:"header-icon",color:"#9C27B0"},{default:t(()=>[a(f)]),_:1}),e[20]||(e[20]=r("span",{class:"card-title"},"AI聊天助手配置",-1))]),a(c,{type:"primary",size:"small",onClick:p.saveAiConfig,loading:l.loadingStates.ai,icon:o.Select},{default:t(()=>e[21]||(e[21]=[d(" 保存 ")])),_:1},8,["onClick","loading","icon"])])]),default:t(()=>[a(x,{title:"此AI助手基于硅基流动提供的免费API",type:"info",closable:!1,style:{"margin-bottom":"16px"}},{default:t(()=>[a(i,{type:"primary",underline:!1,href:"https://cloud.siliconflow.cn/me/account/ak",target:"_blank"},{default:t(()=>e[22]||(e[22]=[d(" 点击前往申请API秘钥 → ")])),_:1})]),_:1}),a(D,{"label-position":"top"},{default:t(()=>[a(h,{label:"API秘钥"},{default:t(()=>[a(g,{modelValue:l.UpdateSysCfgParams.gjAiApi,"onUpdate:modelValue":e[7]||(e[7]=_=>l.UpdateSysCfgParams.gjAiApi=_),placeholder:"请输入API秘钥，例：sk-a*******************************************wvxf",clearable:"","show-password":"",autocomplete:"new-password"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(k,{shadow:"hover",class:"config-card"},{header:t(()=>[r("div",Ce,[r("div",he,[a(m,{class:"header-icon",color:"#F56C6C"},{default:t(()=>[a(T)]),_:1}),e[23]||(e[23]=r("span",{class:"card-title"},"放货播报配置",-1))]),a(c,{type:"primary",size:"small",onClick:p.saveBootBroadcastConfig,loading:l.loadingStates.bootBroadcast,icon:o.Select},{default:t(()=>e[24]||(e[24]=[d(" 保存 ")])),_:1},8,["onClick","loading","icon"])])]),default:t(()=>[a(x,{title:"此 Token 用于推送开机消息通知",type:"info",closable:!1,style:{"margin-bottom":"16px"}},{default:t(()=>[a(i,{type:"primary",underline:!1,href:"https://check.oci-helper.de5.net",target:"_blank"},{default:t(()=>e[25]||(e[25]=[d(" 点击前往查询放货播报面板 → ")])),_:1})]),_:1}),a(D,{"label-position":"top"},{default:t(()=>[a(h,{label:"开机消息推送Token"},{default:t(()=>[a(g,{type:"textarea",modelValue:l.UpdateSysCfgParams.bootBroadcastToken,"onUpdate:modelValue":e[8]||(e[8]=_=>l.UpdateSysCfgParams.bootBroadcastToken=_),placeholder:"请输入Token，例：eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzxxx.xxx",clearable:"","show-password":"",rows:5,resize:"none",autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(k,{shadow:"hover",class:"config-card"},{header:t(()=>[r("div",ye,[r("div",_e,[a(m,{class:"header-icon",color:"#67C23A"},{default:t(()=>[a(M)]),_:1}),e[26]||(e[26]=r("span",{class:"card-title"},"MFA 配置",-1))])])]),default:t(()=>[a(D,{"label-position":"top"},{default:t(()=>[a(h,{label:"启用 MFA"},{default:t(()=>[a(R,{modelValue:l.UpdateSysCfgParams.enableMfa,"onUpdate:modelValue":e[9]||(e[9]=_=>l.UpdateSysCfgParams.enableMfa=_),"active-text":"启用","inactive-text":"禁用",onChange:p.saveMfaConfig},null,8,["modelValue","onChange"])]),_:1}),l.UpdateSysCfgParams.enableMfa?(b(),A(x,{key:0,title:"如果禁用后重新启用，请在 APP 上删除旧验证码并重新扫码绑定新验证码",type:"warning",closable:!1,style:{"margin-bottom":"16px"}})):I("",!0),l.UpdateSysCfgParams.enableMfa?(b(),V("div",be,[a(n,{src:l.UpdateSysCfgParams.mfaQrData,fit:"contain",style:{width:"200px",height:"200px","border-radius":"8px",border:"1px solid #dcdfe6"}},null,8,["src"]),a(g,{modelValue:l.UpdateSysCfgParams.mfaSecret,"onUpdate:modelValue":e[10]||(e[10]=_=>l.UpdateSysCfgParams.mfaSecret=_),style:{"margin-top":"16px"},disabled:"",readonly:""},null,8,["modelValue"])])):I("",!0)]),_:1})]),_:1})])]),_:1}),a(z,{xs:24,sm:24,md:10,lg:10},{default:t(()=>[r("div",De,[a(k,{shadow:"hover",class:"config-card"},{header:t(()=>[r("div",Pe,[r("div",ve,[a(m,{class:"header-icon",color:"#409EFF"},{default:t(()=>[a(F)]),_:1}),e[27]||(e[27]=r("span",{class:"card-title"},"测试消息发送",-1))])])]),default:t(()=>[a(g,{type:"textarea",modelValue:l.message,"onUpdate:modelValue":e[11]||(e[11]=_=>l.message=_),placeholder:"请输入测试文本...",rows:10,resize:"none"},null,8,["modelValue"]),r("div",ke,[a(c,{type:"primary",onClick:p.sendMsg,loading:l.sendLoading,icon:o.Promotion,style:{width:"100%"}},{default:t(()=>e[28]||(e[28]=[d(" 发送测试消息 ")])),_:1},8,["onClick","loading","icon"])])]),_:1}),a(k,{shadow:"hover",class:"config-card"},{header:t(()=>[r("div",Se,[r("div",Re,[a(m,{class:"header-icon",color:"#67C23A"},{default:t(()=>[a(j)]),_:1}),e[29]||(e[29]=r("span",{class:"card-title"},"测试MFA验证码",-1))])])]),default:t(()=>[a(g,{modelValue:l.mfaCode,"onUpdate:modelValue":e[12]||(e[12]=_=>l.mfaCode=_),clearable:"",placeholder:"请输入MFA验证码"},null,8,["modelValue"]),r("div",Ve,[a(c,{type:"primary",onClick:p.checkMfaCode,loading:l.sendMfaCodeLoading,icon:o.CircleCheck,style:{width:"100%"}},{default:t(()=>e[30]||(e[30]=[d(" 验证 ")])),_:1},8,["onClick","loading","icon"])])]),_:1})])]),_:1})]),_:1})])}const xe=B(le,[["render",we],["__scopeId","data-v-16874769"]]),Ie={components:{UploadFilled:$},data(){return{BackupParams:{enableEnc:!1,password:""},RecoverParams:{encryptionKey:"",fileList:[]},RecoverLoading:!1}},methods:{async handleBackup(){var o;if(this.BackupParams.enableEnc&&!((o=this.BackupParams.password)!=null&&o.trim())){u({message:"密钥不能为空",type:"error",duration:2e3});return}try{const e=await this.$axios.post("/sys/backup",{...this.BackupParams},{responseType:"blob"});let S="backup.zip";const U=e.headers["content-disposition"];if(U){const c=/filename\*?=(?:.*'')?(.+)/.exec(U);c&&c[1]&&(S=decodeURIComponent(c[1]))}const l=new Blob([e.data],{type:"application/octet-stream"}),p=window.URL.createObjectURL(l),C=document.createElement("a");C.href=p,C.download=S,C.click(),window.URL.revokeObjectURL(p),u({message:"备份文件已成功下载",type:"success",duration:2e3})}catch(e){console.error("Error during backup:",e),u({message:"备份失败，请重试",type:"error",duration:2e3})}},handleFileUpload({file:o}){const e=new FileReader;e.onload=S=>{S.target.result&&this.RecoverParams.fileList.push(o)},e.readAsArrayBuffer(o)},async handleRecover(){this.RecoverLoading=!0;const o=new FormData;o.append("encryptionKey",this.RecoverParams.encryptionKey),this.RecoverParams.fileList.forEach(e=>{o.append("fileList",e)}),await this.$axios.post("/sys/recover",o,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{e.data.success?(this.resetForm(),u({message:e.data.msg,type:"success",duration:2e3})):(this.RecoverLoading=!1,u({message:e.data.msg,type:"error",duration:2e3}))}).catch(e=>{console.error("Error:",e)}),this.resetForm()},resetForm(){this.BackupParams={enableEnc:!1,password:""},this.RecoverParams={encryptionKey:"",fileList:[]},this.RecoverLoading=!1}}};function Ue(o,e,S,U,l,p){const C=s("el-switch"),m=s("el-form-item"),c=s("el-input"),g=s("el-button"),h=s("el-divider"),D=s("el-text"),k=s("upload-filled"),w=s("el-icon"),P=s("el-upload"),R=s("el-form");return b(),V("div",null,[a(R,null,{default:t(()=>[a(m,{label:"是否启用加密"},{default:t(()=>[a(C,{modelValue:l.BackupParams.enableEnc,"onUpdate:modelValue":e[0]||(e[0]=y=>l.BackupParams.enableEnc=y)},null,8,["modelValue"])]),_:1}),O(a(m,{label:"密钥"},{default:t(()=>[a(c,{modelValue:l.BackupParams.password,"onUpdate:modelValue":e[1]||(e[1]=y=>l.BackupParams.password=y),placeholder:"输入密钥",type:"password","show-password":"",clearable:"",style:{width:"400px"},autocomplete:"new-password"},null,8,["modelValue"])]),_:1},512),[[ee,l.BackupParams.enableEnc]]),a(m,null,{default:t(()=>[a(g,{type:"primary",onClick:p.handleBackup,style:{width:"430px"}},{default:t(()=>e[3]||(e[3]=[d("备份并下载")])),_:1},8,["onClick"])]),_:1}),a(h,{class:"divider"}),a(D,{class:"mx-1"},{default:t(()=>e[4]||(e[4]=[d("上传备份文件")])),_:1}),a(m,{label:"",style:{"margin-top":"10px"}},{default:t(()=>[a(P,{class:"upload-demo",drag:"","http-request":p.handleFileUpload,multiple:"","show-file-list":!0,"file-list":l.RecoverParams.fileList,style:{width:"400px"}},{tip:t(()=>e[5]||(e[5]=[r("div",{class:"el-upload__tip"}," ⭐请上传备份压缩包文件 ",-1)])),default:t(()=>[a(w,{class:"el-icon--upload"},{default:t(()=>[a(k)]),_:1}),e[6]||(e[6]=r("div",{class:"el-upload__text"},[d(" Drop file here or "),r("em",null,"click to upload")],-1))]),_:1},8,["http-request","file-list"])]),_:1}),a(m,{label:"密钥"},{default:t(()=>[a(c,{modelValue:l.RecoverParams.encryptionKey,"onUpdate:modelValue":e[2]||(e[2]=y=>l.RecoverParams.encryptionKey=y),placeholder:"输入密钥（可选）",clearable:"",style:{width:"400px"},type:"password","show-password":"",autocomplete:"new-password"},null,8,["modelValue"])]),_:1}),a(m,null,{default:t(()=>[a(g,{type:"primary",onClick:p.handleRecover,style:{width:"430px"},loading:l.RecoverLoading},{default:t(()=>e[7]||(e[7]=[d("恢复数据 ")])),_:1},8,["onClick","loading"])]),_:1})]),_:1})])}const Ae=B(Ie,[["render",Ue],["__scopeId","data-v-89035c90"]]),Le={props:{cfCfgId:String,cfCfgName:String},mounted(){this.pageParams.cfCfgId=this.cfCfgId,this.getCfDnsRecords()},data(){return{loading:!0,addDnsRecordDialog:!1,addDnsRecordLoading:!1,updateDnsRecordDialog:!1,updateDnsRecordLoading:!1,pageParams:{cfCfgId:"",keyword:"",currentPage:1,pageSize:10,cleanReLaunch:!1},cfDnsRecordsPageRsp:[{id:"",name:"",type:"",content:"",proxiable:null,proxied:null,ttl:null,comment:"",createdOn:"",modifiedOn:"",tags:[]}],total:0,batchSelected:[],removeIds:[],OciAddCfDnsRecordsParams:{cfCfgId:"",prefix:"",type:"",ipAddress:"",proxied:!1,ttl:60,comment:""},OciUpdateCfDnsRecordsParams:{cfCfgId:"",id:"",prefix:"",type:"",ipAddress:"",proxied:!1,ttl:60,comment:""}}},methods:{async reloadCfDnsRecords(){this.pageParams.cleanReLaunch=!0,this.loading=!0,this.getCfDnsRecords(),this.pageParams.cleanReLaunch=!1},async getCfDnsRecords(){this.loading=!0,await this.$axios.post("/cf/listCfDnsRecord",{...this.pageParams}).then(o=>{o.data.success?(this.cfDnsRecordsPageRsp=o.data.data.records,this.total=o.data.data.total):u({message:o.data.msg,type:"error",duration:2e3})}).catch(o=>{console.error("Error:",o)}).finally(()=>{this.cleanCache()})},async batchRemove(){if(!await L("确定要删除 DNS 记录吗？","删除 Cloudflare DNS 记录")){this.$message.info("已取消");return}this.loading=!0,this.removeIds=this.batchSelected.map(e=>e.id),await this.$axios.post("/cf/removeCfDnsRecord",{recordIds:this.removeIds,cfCfgId:this.cfCfgId}).then(e=>{e.data.success?u({message:"删除 Cloudflare DNS 记录成功",type:"success",duration:2e3}):u({message:e.data.msg,type:"error",duration:2e3}),this.reloadCfDnsRecords()}).catch(e=>{console.error("Error:",e)})},async addCfDnsRecords(){if(!await L("确定要新增 DNS 记录吗？","新增 Cloudflare DNS 记录")){this.$message.info("已取消");return}this.OciAddCfDnsRecordsParams.cfCfgId=this.cfCfgId,this.addDnsRecordLoading=!0,await this.$axios.post("/cf/addCfDnsRecord",{...this.OciAddCfDnsRecordsParams}).then(e=>{e.data.success?u({message:"新增 Cloudflare DNS 记录成功",type:"success",duration:2e3}):u({message:e.data.msg,type:"error",duration:2e3}),this.reloadCfDnsRecords()}).catch(e=>{console.error("Error:",e)})},async updateCfDnsRecord(){if(!await L("确定要更新 DNS 记录吗？","更新 Cloudflare DNS 记录")){this.$message.info("已取消");return}this.OciUpdateCfDnsRecordsParams.cfCfgId=this.cfCfgId,this.updateDnsRecordLoading=!0,await this.$axios.post("/cf/updateCfDnsRecord",{...this.OciUpdateCfDnsRecordsParams}).then(e=>{e.data.success?u({message:"更新 Cloudflare DNS 记录成功",type:"success",duration:2e3}):u({message:e.data.msg,type:"error",duration:2e3}),this.reloadCfDnsRecords()}).catch(e=>{console.error("Error:",e)})},handleUpdateDns(o){this.OciUpdateCfDnsRecordsParams.id=o.id,this.OciUpdateCfDnsRecordsParams.type=o.type,this.OciUpdateCfDnsRecordsParams.ipAddress=o.content,this.OciUpdateCfDnsRecordsParams.proxied=o.proxied,this.OciUpdateCfDnsRecordsParams.ttl=o.ttl,this.OciUpdateCfDnsRecordsParams.comment=o.comment;const e=o.name;if(e.endsWith(this.cfCfgName)){const S="."+this.cfCfgName;this.OciUpdateCfDnsRecordsParams.prefix=e.slice(0,-S.length)}this.updateDnsRecordDialog=!0},cleanCache(){this.batchSelected=[],this.loading=!1,this.addDnsRecordLoading=!1,this.addDnsRecordDialog=!1,this.updateDnsRecordLoading=!1,this.updateDnsRecordDialog=!1,this.OciAddCfDnsRecordsParams={},this.OciUpdateCfDnsRecordsParams={}},handleRemove(o){this.batchSelected.push(o),this.batchRemove()},handlePageChange(o){this.pageParams.currentPage=o,this.getCfDnsRecords()},handleSizeChange(o){this.pageParams.currentPage=1,this.pageParams.pageSize=o,this.getCfDnsRecords()},handleSelectionChange(o){this.batchSelected=o}}},Be={style:{"font-size":"16px","font-weight":"bold","margin-left":"20px"}},Te={style:{"overflow-x":"auto"}},ze={class:"dialog-footer"},Oe={class:"dialog-footer"};function Me(o,e,S,U,l,p){const C=s("el-divider"),m=s("el-button"),c=s("el-input"),g=s("el-table-column"),h=s("el-tag"),D=s("el-tooltip"),k=s("el-table"),w=s("el-pagination"),P=s("el-option"),R=s("el-select"),y=s("el-form-item"),f=s("el-switch"),i=s("el-input-number"),x=s("el-form"),T=s("el-dialog"),M=E("loading");return b(),V(N,null,[r("span",Be,"当前配置："+v(this.cfCfgName),1),a(C,{class:"divider"}),a(m,{type:"success",style:{"margin-bottom":"20px"},onClick:p.reloadCfDnsRecords},{default:t(()=>e[24]||(e[24]=[d(" 刷新 ")])),_:1},8,["onClick"]),a(c,{modelValue:l.pageParams.keyword,"onUpdate:modelValue":e[0]||(e[0]=n=>l.pageParams.keyword=n),placeholder:"模糊搜索",onInput:p.getCfDnsRecords,clearable:"","prefix-icon":"Search",style:{"margin-left":"20px",width:"400px","margin-bottom":"20px"}},null,8,["modelValue","onInput"]),a(m,{type:"primary",onClick:e[1]||(e[1]=n=>l.addDnsRecordDialog=!0),style:{"margin-left":"20px","margin-bottom":"20px"}},{default:t(()=>e[25]||(e[25]=[d(" 新增 DNS 记录 ")])),_:1}),a(m,{type:"danger",onClick:p.batchRemove,disabled:!l.batchSelected.length,style:{"margin-left":"20px","margin-bottom":"20px"}},{default:t(()=>e[26]||(e[26]=[d(" 批量删除 ")])),_:1},8,["onClick","disabled"]),r("div",Te,[O((b(),A(k,{data:l.cfDnsRecordsPageRsp,style:{width:"100%","min-width":"800px"},onSelectionChange:p.handleSelectionChange},{default:t(()=>[a(g,{type:"selection",width:"35"}),a(g,{label:"域名",width:"300"},{default:t(({row:n})=>[a(D,{content:n.name,placement:"top"},{default:t(()=>[a(h,{type:"success"},{default:t(()=>[d(v(n.name),1)]),_:2},1024)]),_:2},1032,["content"])]),_:1}),a(g,{label:"类型",width:"100"},{default:t(({row:n})=>[d(v(n.type),1)]),_:1}),a(g,{label:"内容",width:"300"},{default:t(({row:n})=>[a(D,{content:n.content,placement:"top"},{default:t(()=>[d(v(n.content),1)]),_:2},1032,["content"])]),_:1}),a(g,{label:"开启CDN",width:"100"},{default:t(({row:n})=>[a(D,{content:n.proxied===!0?"是":"否",placement:"top"},{default:t(()=>[a(h,{type:n.proxied===!0?"success":"info"},{default:t(()=>[d(v(n.proxied===!0?"是":"否"),1)]),_:2},1032,["type"])]),_:2},1032,["content"])]),_:1}),a(g,{label:"TTL（秒）",width:"100"},{default:t(({row:n})=>[d(v(n.ttl===1?"自动":n.ttl),1)]),_:1}),a(g,{label:"备注"},{default:t(({row:n})=>[a(D,{content:n.comment,placement:"top"},{default:t(()=>[d(v(n.comment),1)]),_:2},1032,["content"])]),_:1}),a(g,{label:"创建时间"},{default:t(({row:n})=>[a(D,{content:n.createdOn,placement:"top"},{default:t(()=>[a(h,{type:"info"},{default:t(()=>[d(v(n.createdOn),1)]),_:2},1024)]),_:2},1032,["content"])]),_:1}),a(g,{label:"操作",width:"220"},{default:t(({row:n})=>[a(m,{onClick:z=>p.handleUpdateDns(n),type:"primary",link:""},{default:t(()=>e[27]||(e[27]=[d(" 编辑 ")])),_:2},1032,["onClick"]),a(m,{onClick:z=>p.handleRemove(n),type:"danger",link:""},{default:t(()=>e[28]||(e[28]=[d(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSelectionChange"])),[[M,l.loading]]),a(w,{onCurrentChange:p.handlePageChange,onSizeChange:p.handleSizeChange,"current-page":l.pageParams.currentPage,"onUpdate:currentPage":e[2]||(e[2]=n=>l.pageParams.currentPage=n),"page-size":l.pageParams.pageSize,"onUpdate:pageSize":e[3]||(e[3]=n=>l.pageParams.pageSize=n),"page-sizes":[5,10,20,50],total:l.total,layout:"total, sizes, prev, pager, next, jumper",style:{"margin-top":"20px"}},null,8,["onCurrentChange","onSizeChange","current-page","page-size","total"])]),a(T,{modelValue:l.addDnsRecordDialog,"onUpdate:modelValue":e[12]||(e[12]=n=>l.addDnsRecordDialog=n),title:"新增 Cloudflare DNS 记录",width:"40%",onClose:e[13]||(e[13]=n=>l.addDnsRecordDialog=!1)},{footer:t(()=>[r("div",ze,[a(m,{type:"info",onClick:e[11]||(e[11]=n=>l.addDnsRecordDialog=!1)},{default:t(()=>e[29]||(e[29]=[d("取消")])),_:1}),a(m,{type:"primary",onClick:p.addCfDnsRecords,loading:l.addDnsRecordLoading},{default:t(()=>e[30]||(e[30]=[d(" 新增 ")])),_:1},8,["onClick","loading"])])]),default:t(()=>[a(x,{"label-width":"100px"},{default:t(()=>[a(y,{label:"记录类型"},{default:t(()=>[a(R,{modelValue:l.OciAddCfDnsRecordsParams.type,"onUpdate:modelValue":e[4]||(e[4]=n=>l.OciAddCfDnsRecordsParams.type=n),placeholder:"请选择记录类型"},{default:t(()=>[a(P,{label:"A (IPv4)",value:"A"}),a(P,{label:"AAAA (IPv6)",value:"AAAA"}),a(P,{label:"CNAME (别名)",value:"CNAME"})]),_:1},8,["modelValue"])]),_:1}),a(y,{label:"域名前缀"},{default:t(()=>[a(c,{modelValue:l.OciAddCfDnsRecordsParams.prefix,"onUpdate:modelValue":e[5]||(e[5]=n=>l.OciAddCfDnsRecordsParams.prefix=n),placeholder:"请输入域名前缀，例如 oracle-kr",clearable:""},null,8,["modelValue"])]),_:1}),l.OciAddCfDnsRecordsParams.type==="A"||l.OciAddCfDnsRecordsParams.type==="AAAA"?(b(),A(y,{key:0,label:"IP 地址"},{default:t(()=>[a(c,{modelValue:l.OciAddCfDnsRecordsParams.ipAddress,"onUpdate:modelValue":e[6]||(e[6]=n=>l.OciAddCfDnsRecordsParams.ipAddress=n),placeholder:"请输入 IP 地址",clearable:""},null,8,["modelValue"])]),_:1})):I("",!0),l.OciAddCfDnsRecordsParams.type==="CNAME"?(b(),A(y,{key:1,label:"目标域名"},{default:t(()=>[a(c,{modelValue:l.OciAddCfDnsRecordsParams.ipAddress,"onUpdate:modelValue":e[7]||(e[7]=n=>l.OciAddCfDnsRecordsParams.ipAddress=n),placeholder:"请输入目标域名，例如 target.example.com",clearable:""},null,8,["modelValue"])]),_:1})):I("",!0),a(y,{label:"代理加速"},{default:t(()=>[a(f,{modelValue:l.OciAddCfDnsRecordsParams.proxied,"onUpdate:modelValue":e[8]||(e[8]=n=>l.OciAddCfDnsRecordsParams.proxied=n),"active-text":"开启","inactive-text":"关闭"},null,8,["modelValue"])]),_:1}),a(y,{label:"TTL（秒）"},{default:t(()=>[a(i,{modelValue:l.OciAddCfDnsRecordsParams.ttl,"onUpdate:modelValue":e[9]||(e[9]=n=>l.OciAddCfDnsRecordsParams.ttl=n),min:60,step:60,placeholder:"TTL 秒数"},null,8,["modelValue"])]),_:1}),a(y,{label:"备注"},{default:t(()=>[a(c,{type:"textarea",modelValue:l.OciAddCfDnsRecordsParams.comment,"onUpdate:modelValue":e[10]||(e[10]=n=>l.OciAddCfDnsRecordsParams.comment=n),placeholder:"可填写备注",rows:"2",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(T,{modelValue:l.updateDnsRecordDialog,"onUpdate:modelValue":e[22]||(e[22]=n=>l.updateDnsRecordDialog=n),title:"更新 Cloudflare DNS 记录",width:"40%",onClose:e[23]||(e[23]=n=>l.updateDnsRecordDialog=!1)},{footer:t(()=>[r("div",Oe,[a(m,{type:"info",onClick:e[21]||(e[21]=n=>l.updateDnsRecordDialog=!1)},{default:t(()=>e[31]||(e[31]=[d("取消")])),_:1}),a(m,{type:"primary",onClick:p.updateCfDnsRecord,loading:l.updateDnsRecordLoading},{default:t(()=>e[32]||(e[32]=[d(" 更新 ")])),_:1},8,["onClick","loading"])])]),default:t(()=>[a(x,{"label-width":"100px"},{default:t(()=>[a(y,{label:"记录类型"},{default:t(()=>[a(R,{modelValue:l.OciUpdateCfDnsRecordsParams.type,"onUpdate:modelValue":e[14]||(e[14]=n=>l.OciUpdateCfDnsRecordsParams.type=n),placeholder:"请选择记录类型",disabled:""},{default:t(()=>[a(P,{label:"A (IPv4)",value:"A"}),a(P,{label:"AAAA (IPv6)",value:"AAAA"}),a(P,{label:"CNAME (别名)",value:"CNAME"})]),_:1},8,["modelValue"])]),_:1}),a(y,{label:"域名前缀"},{default:t(()=>[a(c,{modelValue:l.OciUpdateCfDnsRecordsParams.prefix,"onUpdate:modelValue":e[15]||(e[15]=n=>l.OciUpdateCfDnsRecordsParams.prefix=n),placeholder:"请输入域名前缀",clearable:""},null,8,["modelValue"])]),_:1}),l.OciUpdateCfDnsRecordsParams.type==="A"||l.OciUpdateCfDnsRecordsParams.type==="AAAA"?(b(),A(y,{key:0,label:"IP 地址"},{default:t(()=>[a(c,{modelValue:l.OciUpdateCfDnsRecordsParams.ipAddress,"onUpdate:modelValue":e[16]||(e[16]=n=>l.OciUpdateCfDnsRecordsParams.ipAddress=n),placeholder:"请输入 IP 地址",clearable:""},null,8,["modelValue"])]),_:1})):I("",!0),l.OciUpdateCfDnsRecordsParams.type==="CNAME"?(b(),A(y,{key:1,label:"目标域名"},{default:t(()=>[a(c,{modelValue:l.OciUpdateCfDnsRecordsParams.ipAddress,"onUpdate:modelValue":e[17]||(e[17]=n=>l.OciUpdateCfDnsRecordsParams.ipAddress=n),placeholder:"请输入目标域名",clearable:""},null,8,["modelValue"])]),_:1})):I("",!0),a(y,{label:"代理加速"},{default:t(()=>[a(f,{modelValue:l.OciUpdateCfDnsRecordsParams.proxied,"onUpdate:modelValue":e[18]||(e[18]=n=>l.OciUpdateCfDnsRecordsParams.proxied=n),"active-text":"开启","inactive-text":"关闭"},null,8,["modelValue"])]),_:1}),a(y,{label:"TTL（秒）"},{default:t(()=>[a(i,{modelValue:l.OciUpdateCfDnsRecordsParams.ttl,"onUpdate:modelValue":e[19]||(e[19]=n=>l.OciUpdateCfDnsRecordsParams.ttl=n),min:60,step:60,placeholder:"TTL 秒数"},null,8,["modelValue"])]),_:1}),a(y,{label:"备注"},{default:t(()=>[a(c,{type:"textarea",modelValue:l.OciUpdateCfDnsRecordsParams.comment,"onUpdate:modelValue":e[20]||(e[20]=n=>l.OciUpdateCfDnsRecordsParams.comment=n),placeholder:"备注信息",rows:"2",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}const Ee=B(Le,[["render",Me],["__scopeId","data-v-02cda709"]]),Ne={components:{CloudflareDnsRecords:Ee},mounted(){this.getCfCfgList()},data(){return{addCfCfgDialog:!1,addCfCfgLoading:!1,updateCfCfgDialog:!1,updateCfCfgLoading:!1,showCfDnsRecords:!1,cfCfgId:null,cfCfgName:"",loading:!0,pageParams:{keyword:"",currentPage:1,pageSize:10},cfCfgPageRsp:[{id:"",domain:"",zoneId:"",apiToken:"",createTime:""}],total:0,batchSelected:[],removeIds:[],AddCfCfgParams:{domain:"",zoneId:"",apiToken:""},UpdateCfCfgParams:{id:"",domain:"",zoneId:"",apiToken:""}}},methods:{async getCfCfgList(){this.loading=!0,await this.$axios.post("/cf/listCfg",{...this.pageParams}).then(o=>{o.data.success?(this.cfCfgPageRsp=o.data.data.records,this.total=o.data.data.total):u({message:o.data.msg,type:"error",duration:2e3})}).catch(o=>{console.error("Error:",o)}).finally(()=>{this.cleanCache()})},async batchRemove(){if(!await L("确定要删除配置吗？","删除 Cloudflare 配置")){this.$message.info("已取消");return}this.loading=!0,this.removeIds=this.batchSelected.map(e=>e.id),await this.$axios.post("/cf/removeBatch",{idList:this.removeIds}).then(e=>{e.data.success?u({message:"删除 Cloudflare 配置成功",type:"success",duration:2e3}):u({message:e.data.msg,type:"error",duration:2e3}),this.getCfCfgList()}).catch(e=>{console.error("Error:",e)})},async addCfCfg(){if(!await L("确定要新增配置吗？","新增 Cloudflare 配置")){this.$message.info("已取消");return}this.addCfCfgLoading=!0,await this.$axios.post("/cf/add",{...this.AddCfCfgParams}).then(e=>{e.data.success?(u({message:"新增 Cloudflare 配置成功",type:"success",duration:2e3}),this.addCfCfgDialog=!1):u({message:e.data.msg,type:"error",duration:2e3}),this.getCfCfgList()}).catch(e=>{console.error("Error:",e)})},async updateCfCfg(){if(!await L("确定要修改配置吗？","修改 Cloudflare 配置")){this.$message.info("已取消");return}this.updateCfCfgLoading=!0,await this.$axios.post("/cf/update",{...this.UpdateCfCfgParams}).then(e=>{e.data.success?(u({message:"修改 Cloudflare 配置成功",type:"success",duration:2e3}),this.updateCfCfgDialog=!1):u({message:e.data.msg,type:"error",duration:2e3}),this.getCfCfgList()}).catch(e=>{console.error("Error:",e)})},handleUpdateCfCfg(o){this.UpdateCfCfgParams.id=o.id,this.UpdateCfCfgParams.domain=o.domain,this.UpdateCfCfgParams.zoneId=o.zoneId,this.UpdateCfCfgParams.apiToken=o.apiToken,this.updateCfCfgDialog=!0},cleanCache(){this.batchSelected=[],this.AddCfCfgParams={},this.loading=!1,this.addCfCfgLoading=!1,this.updateCfCfgLoading=!1},handleRemove(o){this.batchSelected.push(o),this.batchRemove()},handleCfDnsRecords(o){this.cfCfgId=o.id,this.cfCfgName=o.domain,this.showCfDnsRecords=!0},handlePageChange(o){this.pageParams.currentPage=o,this.getCfCfgList()},handleSizeChange(o){this.pageParams.currentPage=1,this.pageParams.pageSize=o,this.getCfCfgList()},handleSelectionChange(o){this.batchSelected=o}}},Fe={key:0},je={style:{"overflow-x":"auto"}},Ke={key:1},Qe={class:"dialog-footer"},Je={class:"dialog-footer"};function qe(o,e,S,U,l,p){const C=s("el-button"),m=s("el-input"),c=s("el-table-column"),g=s("el-tag"),h=s("el-tooltip"),D=s("el-table"),k=s("el-pagination"),w=s("CloudflareDnsRecords"),P=s("el-form-item"),R=s("el-form"),y=s("el-dialog"),f=E("loading");return b(),V(N,null,[r("div",null,[l.showCfDnsRecords?(b(),V("div",Ke,[a(C,{onClick:e[4]||(e[4]=i=>l.showCfDnsRecords=!1)},{default:t(()=>e[25]||(e[25]=[d("返回 Cloudflare 配置列表")])),_:1}),a(w,{cfCfgId:l.cfCfgId,cfCfgName:l.cfCfgName},null,8,["cfCfgId","cfCfgName"])])):(b(),V("div",Fe,[a(C,{type:"success",style:{"margin-bottom":"20px"},onClick:p.getCfCfgList},{default:t(()=>e[19]||(e[19]=[d(" 刷新 ")])),_:1},8,["onClick"]),a(m,{modelValue:l.pageParams.keyword,"onUpdate:modelValue":e[0]||(e[0]=i=>l.pageParams.keyword=i),placeholder:"模糊搜索",onInput:p.getCfCfgList,clearable:"","prefix-icon":"Search",style:{"margin-left":"20px",width:"400px","margin-bottom":"20px"}},null,8,["modelValue","onInput"]),a(C,{type:"primary",onClick:e[1]||(e[1]=i=>l.addCfCfgDialog=!0),style:{"margin-left":"20px","margin-bottom":"20px"}},{default:t(()=>e[20]||(e[20]=[d(" 新增配置 ")])),_:1}),a(C,{type:"danger",onClick:p.batchRemove,disabled:!l.batchSelected.length,style:{"margin-left":"20px","margin-bottom":"20px"}},{default:t(()=>e[21]||(e[21]=[d(" 批量删除 ")])),_:1},8,["onClick","disabled"]),r("div",je,[O((b(),A(D,{data:l.cfCfgPageRsp,style:{width:"100%","min-width":"800px"},onSelectionChange:p.handleSelectionChange},{default:t(()=>[a(c,{type:"selection",width:"35"}),a(c,{label:"域名",width:"300"},{default:t(({row:i})=>[a(h,{content:i.domain,placement:"top"},{default:t(()=>[a(g,{type:"success"},{default:t(()=>[d(v(i.domain),1)]),_:2},1024)]),_:2},1032,["content"])]),_:1}),a(c,{label:"ZoneId",width:"350"},{default:t(({row:i})=>[a(h,{content:i.zoneId,placement:"top"},{default:t(()=>[d(v(i.zoneId),1)]),_:2},1032,["content"])]),_:1}),a(c,{label:"Token",width:"400"},{default:t(({row:i})=>[a(h,{content:i.apiToken,placement:"top"},{default:t(()=>[d(v(i.apiToken),1)]),_:2},1032,["content"])]),_:1}),a(c,{label:"创建时间"},{default:t(({row:i})=>[a(h,{content:i.createTime,placement:"top"},{default:t(()=>[a(g,{type:"info"},{default:t(()=>[d(v(i.createTime),1)]),_:2},1024)]),_:2},1032,["content"])]),_:1}),a(c,{label:"操作",width:"220"},{default:t(({row:i})=>[a(C,{onClick:x=>p.handleUpdateCfCfg(i),type:"primary",link:""},{default:t(()=>e[22]||(e[22]=[d(" 编辑 ")])),_:2},1032,["onClick"]),a(C,{onClick:x=>p.handleCfDnsRecords(i),type:"success",link:""},{default:t(()=>e[23]||(e[23]=[d(" DNS记录 ")])),_:2},1032,["onClick"]),a(C,{onClick:x=>p.handleRemove(i),type:"danger",link:""},{default:t(()=>e[24]||(e[24]=[d(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSelectionChange"])),[[f,l.loading]])]),a(k,{onCurrentChange:p.handlePageChange,onSizeChange:p.handleSizeChange,"current-page":l.pageParams.currentPage,"onUpdate:currentPage":e[2]||(e[2]=i=>l.pageParams.currentPage=i),"page-size":l.pageParams.pageSize,"onUpdate:pageSize":e[3]||(e[3]=i=>l.pageParams.pageSize=i),"page-sizes":[5,10,20,50],total:l.total,layout:"total, sizes, prev, pager, next, jumper",style:{"margin-top":"20px"}},null,8,["onCurrentChange","onSizeChange","current-page","page-size","total"])]))]),a(y,{modelValue:l.addCfCfgDialog,"onUpdate:modelValue":e[10]||(e[10]=i=>l.addCfCfgDialog=i),title:"新增 Cloudflare 配置名称",width:"40%",onClose:e[11]||(e[11]=i=>l.addCfCfgDialog=!1)},{footer:t(()=>[r("div",Qe,[a(C,{type:"info",onClick:e[8]||(e[8]=i=>l.addCfCfgDialog=!1)},{default:t(()=>e[26]||(e[26]=[d("取消")])),_:1}),a(C,{type:"primary",onClick:e[9]||(e[9]=i=>p.addCfCfg()),loading:l.addCfCfgLoading},{default:t(()=>e[27]||(e[27]=[d("新增")])),_:1},8,["loading"])])]),default:t(()=>[a(R,{"label-width":"100px"},{default:t(()=>[a(P,{label:"域名","label-width":"130"},{default:t(()=>[a(m,{class:"cf-input",modelValue:l.AddCfCfgParams.domain,"onUpdate:modelValue":e[5]||(e[5]=i=>l.AddCfCfgParams.domain=i),placeholder:"请输入托管于 Cloudflare 的域名，例：abc.xyz",clearable:"",autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(P,{label:"区域ID (ZoneId)","label-width":"130"},{default:t(()=>[a(m,{class:"cf-input",modelValue:l.AddCfCfgParams.zoneId,"onUpdate:modelValue":e[6]||(e[6]=i=>l.AddCfCfgParams.zoneId=i),placeholder:"请输入托管于 Cloudflare 的域名的区域ID",clearable:"",autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(P,{label:"API令牌 (Token)","label-width":"130"},{default:t(()=>[a(m,{class:"cf-input",modelValue:l.AddCfCfgParams.apiToken,"onUpdate:modelValue":e[7]||(e[7]=i=>l.AddCfCfgParams.apiToken=i),placeholder:"请输入托管于 Cloudflare 的域名的 API令牌（需要自行生成）",clearable:"",autocomplete:"new-password"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(y,{modelValue:l.updateCfCfgDialog,"onUpdate:modelValue":e[17]||(e[17]=i=>l.updateCfCfgDialog=i),title:"修改 Cloudflare 配置名称",width:"40%",onClose:e[18]||(e[18]=i=>l.updateCfCfgDialog=!1)},{footer:t(()=>[r("div",Je,[a(C,{type:"info",onClick:e[15]||(e[15]=i=>l.updateCfCfgDialog=!1)},{default:t(()=>e[28]||(e[28]=[d("取消")])),_:1}),a(C,{type:"primary",onClick:e[16]||(e[16]=i=>p.updateCfCfg()),loading:l.updateCfCfgLoading},{default:t(()=>e[29]||(e[29]=[d("修改")])),_:1},8,["loading"])])]),default:t(()=>[a(R,{"label-width":"100px"},{default:t(()=>[a(P,{label:"域名","label-width":"130"},{default:t(()=>[a(m,{class:"cf-input",modelValue:l.UpdateCfCfgParams.domain,"onUpdate:modelValue":e[12]||(e[12]=i=>l.UpdateCfCfgParams.domain=i),placeholder:"请输入托管于 Cloudflare 的域名，例：abc.xyz",clearable:"",autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(P,{label:"区域ID (ZoneId)","label-width":"130"},{default:t(()=>[a(m,{class:"cf-input",modelValue:l.UpdateCfCfgParams.zoneId,"onUpdate:modelValue":e[13]||(e[13]=i=>l.UpdateCfCfgParams.zoneId=i),placeholder:"请输入托管于 Cloudflare 的域名的区域ID",clearable:"",autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(P,{label:"API令牌 (Token)","label-width":"130"},{default:t(()=>[a(m,{class:"cf-input",modelValue:l.UpdateCfCfgParams.apiToken,"onUpdate:modelValue":e[14]||(e[14]=i=>l.UpdateCfCfgParams.apiToken=i),placeholder:"请输入托管于 Cloudflare 的域名的 API令牌（需要自行生成）",clearable:"",autocomplete:"new-password"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}const Ze=B(Ne,[["render",qe],["__scopeId","data-v-82e2a950"]]),We={components:{},mounted(){this.getMapDataList()},data(){return{addMapData:!1,addIpDataLoading:!1,removeIpDataLoading:!1,updateIpDataLoading:!1,loading:!0,pageParams:{keyword:"",currentPage:1,pageSize:10},addIpDataParams:{ip:""},mapDataPageRsp:[{id:"1",ip:"1.1.1.1",country:"AU",area:"New South Wales",city:"Sydney",org:"CLOUDFLARENET",asn:"AS13335",lat:-33.859336,lng:151.203624,createTime:"2025-07-30 15:08:47"}],total:0,batchSelected:[],removeIds:[]}},methods:{copyToClipboard:ae,async getMapDataList(){this.loading=!0,await this.$axios.post("/ipData/page",{...this.pageParams}).then(o=>{o.data.success?(this.mapDataPageRsp=o.data.data.records,this.total=o.data.data.total,u({message:"获取IP数据列表成功",type:"success",duration:2e3})):u({message:o.data.msg,type:"error",duration:2e3})}).catch(o=>{console.error("Error:",o)}).finally(()=>{this.cleanCache()})},async addIpData(){this.addIpDataLoading=!0,await this.$axios.post("/ipData/add",{...this.addIpDataParams}).then(o=>{o.data.success?u({message:"新增IP数据成功",type:"success",duration:2e3}):u({message:o.data.msg,type:"error",duration:2e3})}).catch(o=>{console.error("Error:",o)}).finally(()=>{this.cleanCache(),this.getMapDataList()})},async updateOciCfgIpData(){if(!await L("确定要同步所有已存在的oci配置的最新IP数据吗？","同步已有的oci配置的IP信息")){this.$message.info("已取消");return}this.loading=!0,this.$axios.post("/ipData/loadOciIpData",{}).then(e=>{e.data.success?u({message:"同步IP数据任务下发成功，请稍后自行刷新列表查看",type:"success",duration:2e3}):u({message:e.data.msg,type:"error",duration:2e3})}).catch(e=>{console.error("Error:",e)}).finally(()=>{this.cleanCache(),this.getMapDataList()})},async batchRemove(){if(!await L("确定要删除IP数据吗？","删除首页地图IP数据")){this.$message.info("已取消");return}this.removeIpDataLoading=!0,this.removeIds=this.batchSelected.map(e=>e.id),await this.$axios.post("/ipData/remove",{idList:this.removeIds}).then(e=>{e.data.success?u({message:"删除IP数据成功",type:"success",duration:2e3}):u({message:e.data.msg,type:"error",duration:2e3})}).catch(e=>{console.error("Error:",e)}).finally(()=>{this.cleanCache(),this.getMapDataList()})},async updateIpInfo(o){if(!await L("确定要更新IP："+o.ip+" 的数据信息吗？","更新IP数据")){this.$message.info("已取消");return}this.updateIpDataLoading=!0,await this.$axios.post("/ipData/update",{id:o.id}).then(S=>{S.data.success?u({message:"更新IP数据成功",type:"success",duration:2e3}):u({message:S.data.msg,type:"error",duration:2e3})}).catch(S=>{console.error("Error:",S)}).finally(()=>{this.cleanCache(),this.getMapDataList()})},cleanCache(){this.batchSelected=[],this.removeIds=[],this.loading=!1,this.addIpDataLoading=!1,this.removeIpDataLoading=!1,this.updateIpDataLoading=!1,this.addMapData=!1,this.addIpDataParams.ip=""},handleRemove(o){this.batchSelected.push(o),this.batchRemove()},handlePageChange(o){this.pageParams.currentPage=o,this.getMapDataList()},handleSizeChange(o){this.pageParams.currentPage=1,this.pageParams.pageSize=o,this.getMapDataList()},handleSelectionChange(o){this.batchSelected=o}}},Ge={style:{"overflow-x":"auto"}},Xe={class:"dialog-footer"};function He(o,e,S,U,l,p){const C=s("el-button"),m=s("el-input"),c=s("el-table-column"),g=s("el-tag"),h=s("el-tooltip"),D=s("el-table"),k=s("el-pagination"),w=s("el-form-item"),P=s("el-form"),R=s("el-dialog"),y=E("loading");return b(),V(N,null,[r("div",null,[a(C,{type:"success",style:{"margin-bottom":"20px"},onClick:p.getMapDataList},{default:t(()=>e[9]||(e[9]=[d(" 刷新 ")])),_:1},8,["onClick"]),a(m,{modelValue:l.pageParams.keyword,"onUpdate:modelValue":e[0]||(e[0]=f=>l.pageParams.keyword=f),placeholder:"模糊搜索",onInput:p.getMapDataList,clearable:"","prefix-icon":"Search",style:{"margin-left":"20px",width:"400px","margin-bottom":"20px"}},null,8,["modelValue","onInput"]),a(C,{type:"primary",onClick:e[1]||(e[1]=f=>l.addMapData=!0),style:{"margin-left":"20px","margin-bottom":"20px"}},{default:t(()=>e[10]||(e[10]=[d(" 新增IP数据 ")])),_:1}),a(C,{type:"primary",onClick:p.updateOciCfgIpData,style:{"margin-left":"20px","margin-bottom":"20px"}},{default:t(()=>e[11]||(e[11]=[d(" 同步已有的oci配置最新数据 ")])),_:1},8,["onClick"]),a(C,{type:"danger",onClick:p.batchRemove,disabled:!l.batchSelected.length,style:{"margin-left":"20px","margin-bottom":"20px"}},{default:t(()=>e[12]||(e[12]=[d(" 批量删除 ")])),_:1},8,["onClick","disabled"]),r("div",Ge,[O((b(),A(D,{data:l.mapDataPageRsp,style:{width:"100%","min-width":"800px"},onSelectionChange:p.handleSelectionChange},{default:t(()=>[a(c,{type:"selection",width:"35"}),a(c,{label:"IP地址",width:"260"},{default:t(({row:f})=>[a(h,{content:f.ip,placement:"top"},{default:t(()=>[a(g,{type:"success",onClick:i=>p.copyToClipboard(f.ip)},{default:t(()=>[d(v(f.ip),1)]),_:2},1032,["onClick"])]),_:2},1032,["content"])]),_:1}),a(c,{label:"国家"},{default:t(({row:f})=>[a(h,{content:f.country,placement:"top"},{default:t(()=>[a(g,{type:"primary"},{default:t(()=>[d(v(f.country),1)]),_:2},1024)]),_:2},1032,["content"])]),_:1}),a(c,{label:"地区"},{default:t(({row:f})=>[a(h,{content:f.area,placement:"top"},{default:t(()=>[d(v(f.area),1)]),_:2},1032,["content"])]),_:1}),a(c,{label:"城市"},{default:t(({row:f})=>[a(h,{content:f.city,placement:"top"},{default:t(()=>[d(v(f.city),1)]),_:2},1032,["content"])]),_:1}),a(c,{label:"组织"},{default:t(({row:f})=>[a(h,{content:f.org,placement:"top"},{default:t(()=>[d(v(f.org),1)]),_:2},1032,["content"])]),_:1}),a(c,{label:"ASN"},{default:t(({row:f})=>[a(h,{content:f.asn,placement:"top"},{default:t(()=>[a(g,{type:"warning"},{default:t(()=>[d(v(f.asn),1)]),_:2},1024)]),_:2},1032,["content"])]),_:1}),a(c,{label:"纬度"},{default:t(({row:f})=>[a(h,{content:f.lat,placement:"top"},{default:t(()=>[a(g,{type:"primary"},{default:t(()=>[d(v(f.lat),1)]),_:2},1024)]),_:2},1032,["content"])]),_:1}),a(c,{label:"经度"},{default:t(({row:f})=>[a(h,{content:f.lng,placement:"top"},{default:t(()=>[a(g,{type:"primary"},{default:t(()=>[d(v(f.lng),1)]),_:2},1024)]),_:2},1032,["content"])]),_:1}),a(c,{label:"操作",width:"220"},{default:t(({row:f})=>[a(C,{onClick:i=>p.updateIpInfo(f),type:"success",link:""},{default:t(()=>e[13]||(e[13]=[d(" 更新IP信息 ")])),_:2},1032,["onClick"]),a(C,{onClick:i=>p.handleRemove(f),type:"danger",link:""},{default:t(()=>e[14]||(e[14]=[d(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSelectionChange"])),[[y,l.loading]])]),a(k,{onCurrentChange:p.handlePageChange,onSizeChange:p.handleSizeChange,"current-page":l.pageParams.currentPage,"onUpdate:currentPage":e[2]||(e[2]=f=>l.pageParams.currentPage=f),"page-size":l.pageParams.pageSize,"onUpdate:pageSize":e[3]||(e[3]=f=>l.pageParams.pageSize=f),"page-sizes":[5,10,20,50],total:l.total,layout:"total, sizes, prev, pager, next, jumper",style:{"margin-top":"20px"}},null,8,["onCurrentChange","onSizeChange","current-page","page-size","total"])]),a(R,{modelValue:l.addMapData,"onUpdate:modelValue":e[7]||(e[7]=f=>l.addMapData=f),title:"新增地图IP数据",width:"40%",onClose:e[8]||(e[8]=f=>l.addMapData=!1)},{footer:t(()=>[r("div",Xe,[a(C,{type:"info",onClick:e[5]||(e[5]=f=>l.addMapData=!1)},{default:t(()=>e[15]||(e[15]=[d("取消")])),_:1}),a(C,{type:"primary",onClick:e[6]||(e[6]=f=>p.addIpData()),loading:l.addIpDataLoading},{default:t(()=>e[16]||(e[16]=[d("新增")])),_:1},8,["loading"])])]),default:t(()=>[a(P,{"label-width":"200px"},{default:t(()=>[a(w,{label:"IP地址（支持v4、v6）","label-width":"150px"},{default:t(()=>[a(m,{class:"cf-input",modelValue:l.addIpDataParams.ip,"onUpdate:modelValue":e[4]||(e[4]=f=>l.addIpDataParams.ip=f),placeholder:"请输入IP地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}const Ye=B(We,[["render",He]]),$e={data(){return{activeTab:"basicCfg"}},components:{BasicCfg:xe,BackUp:Ae,CloudflareCfg:Ze,IpDataView:te,MapData:Ye}},ea={class:"tab-content"},aa={key:0},ta={key:1},la={key:2},oa={key:3},sa={key:4};function na(o,e,S,U,l,p){const C=s("Setting"),m=s("el-icon"),c=s("el-tab-pane"),g=s("DocumentCopy"),h=s("MostlyCloudy"),D=s("Search"),k=s("MapLocation"),w=s("BasicCfg"),P=s("BackUp"),R=s("CloudflareCfg"),y=s("IpDataView"),f=s("MapData"),i=s("el-tabs");return b(),A(i,{type:"border-card",class:"demo-tabs",modelValue:l.activeTab,"onUpdate:modelValue":e[0]||(e[0]=x=>l.activeTab=x)},{default:t(()=>[a(c,{label:"basicCfg",name:"basicCfg"},{label:t(()=>[r("span",null,[a(m,null,{default:t(()=>[a(C)]),_:1}),e[1]||(e[1]=r("span",{style:{"margin-left":"5px"}},"基本设置",-1))])]),_:1}),a(c,{label:"backup",name:"backup"},{label:t(()=>[r("span",null,[a(m,null,{default:t(()=>[a(g)]),_:1}),e[2]||(e[2]=r("span",{style:{"margin-left":"5px"}},"备份恢复",-1))])]),_:1}),a(c,{label:"cfCfg",name:"cfCfg"},{label:t(()=>[r("span",null,[a(m,null,{default:t(()=>[a(h)]),_:1}),e[3]||(e[3]=r("span",{style:{"margin-left":"5px"}},"Cloudflare配置",-1))])]),_:1}),a(c,{label:"ipData",name:"ipData"},{label:t(()=>[r("span",null,[a(m,null,{default:t(()=>[a(D)]),_:1}),e[4]||(e[4]=r("span",{style:{"margin-left":"5px"}},"IP信息查询",-1))])]),_:1}),a(c,{label:"mapData",name:"mapData"},{label:t(()=>[r("span",null,[a(m,null,{default:t(()=>[a(k)]),_:1}),e[5]||(e[5]=r("span",{style:{"margin-left":"5px"}},"地图数据",-1))])]),_:1}),r("div",ea,[l.activeTab==="basicCfg"?(b(),V("div",aa,[a(w)])):I("",!0),l.activeTab==="backup"?(b(),V("div",ta,[a(P)])):I("",!0),l.activeTab==="cfCfg"?(b(),V("div",la,[a(R)])):I("",!0),l.activeTab==="ipData"?(b(),V("div",oa,[a(y)])):I("",!0),l.activeTab==="mapData"?(b(),V("div",sa,[a(f)])):I("",!0)])]),_:1},8,["modelValue"])}const fa=B($e,[["render",na]]);export{fa as default};
