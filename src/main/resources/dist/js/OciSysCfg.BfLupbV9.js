import{N as K,O as J,P as Q,Q as q,R as H,S as W,T as Z,U as X,V as Y,k as u,c as V,o as b,b as a,w as t,r as s,a as n,s as i,p as U,q as x,D as $,z as O,A as ee,t as k,B as E,F as N}from"./chunk-vendors.c9FUtYPc.js";import{_ as B}from"./index.Cw0fWXUa.js";import{a as L,c as ae}from"./common.B9tJp7PO.js";import te from"./IpDataView.Bpn2f6aZ.js";const le={components:{ChatDotRound:Y,Bell:X,Notification:Z,Calendar:W,ChatLineRound:H,MessageBox:q,Lock:Q,Promotion:J,Key:K},data(){return{loadingStates:{telegram:!1,ding:!1,dailyBroadcast:!1,ai:!1,bootBroadcast:!1,google:!1},sendLoading:!1,sendMfaCodeLoading:!1,UpdateSysCfgParams:{dingToken:"",dingSecret:"",tgChatId:"",tgBotToken:"",enableMfa:!1,mfaSecret:"",mfaQrData:"",enableDailyBroadcast:!0,dailyBroadcastCron:"",enableVersionInform:!0,gjAiApi:"",bootBroadcastToken:"",enableGoogleLogin:!1,googleClientId:"",allowedEmails:""},message:"",mfaCode:""}},mounted(){this.getSysCfg()},methods:{async getSysCfg(){await this.$axios.post("/sys/getSysCfg",{}).then(o=>{if(o.data.success){const e=o.data.data;console.log("Backend data received:",e),this.UpdateSysCfgParams={dingToken:e.dingToken||"",dingSecret:e.dingSecret||"",tgChatId:e.tgChatId||"",tgBotToken:e.tgBotToken||"",enableMfa:e.enableMfa||!1,mfaSecret:e.mfaSecret||"",mfaQrData:e.mfaQrData||"",enableDailyBroadcast:e.enableDailyBroadcast!==void 0?e.enableDailyBroadcast:!0,dailyBroadcastCron:e.dailyBroadcastCron||"",enableVersionInform:e.enableVersionInform!==void 0?e.enableVersionInform:!0,gjAiApi:e.gjAiApi||"",bootBroadcastToken:e.bootBroadcastToken||"",enableGoogleLogin:e.enableGoogleLogin||!1,googleClientId:e.googleClientId||"",allowedEmails:e.allowedEmails||""},console.log("Updated params:",this.UpdateSysCfgParams)}else u({message:o.data.msg,type:"error",duration:2e3})}).catch(o=>{console.error("Error:",o),u({message:"获取配置失败",type:"error",duration:2e3})})},async saveTelegramConfig(){this.loadingStates.telegram=!0,await this.updateSysCfg(),this.loadingStates.telegram=!1},async saveDingConfig(){this.loadingStates.ding=!0,await this.updateSysCfg(),this.loadingStates.ding=!1},async saveVersionInformConfig(){await this.updateSysCfg()},async saveDailyBroadcastConfig(){this.loadingStates.dailyBroadcast=!0,await this.updateSysCfg(),this.loadingStates.dailyBroadcast=!1},async saveAiConfig(){this.loadingStates.ai=!0,await this.updateSysCfg(),this.loadingStates.ai=!1},async saveBootBroadcastConfig(){this.loadingStates.bootBroadcast=!0,await this.updateSysCfg(),this.loadingStates.bootBroadcast=!1},async saveMfaConfig(){await this.updateSysCfg()},async saveGoogleConfig(){this.loadingStates.google=!0,await this.updateSysCfg(),this.loadingStates.google=!1},async updateSysCfg(){await this.$axios.post("/sys/updateSysCfg",{...this.UpdateSysCfgParams}).then(o=>{o.data.success?(u({message:o.data.msg,type:"success",duration:2e3}),this.getSysCfg()):u({message:o.data.msg,type:"error",duration:2e3})}).catch(o=>{console.error("Error:",o),u({message:"保存配置失败",type:"error",duration:2e3})})},async sendMsg(){this.sendLoading=!0,await this.$axios.post("/sys/sendMsg",{message:this.message}).then(o=>{o.data.success?u({message:o.data.msg,type:"success",duration:2e3}):u({message:o.data.msg,type:"error",duration:2e3})}).catch(o=>{console.error("Error:",o)}),this.sendLoading=!1},async checkMfaCode(){this.sendMfaCodeLoading=!0,await this.$axios.post("/sys/checkMfaCode",{mfaCode:this.mfaCode}).then(o=>{o.data.success?u({message:o.data.msg,type:"success",duration:2e3}):u({message:o.data.msg,type:"error",duration:2e3})}).catch(o=>{console.error("Error:",o)}),this.sendMfaCodeLoading=!1}}},oe={class:"config-container"},se={class:"config-section"},ne={class:"card-header"},de={class:"header-left"},ie={class:"card-header"},re={class:"header-left"},pe={class:"card-header"},fe={class:"header-left"},ce={class:"card-header"},me={class:"header-left"},ue={class:"card-header"},ge={class:"header-left"},Ce={class:"card-header"},ye={class:"header-left"},he={class:"card-header"},_e={class:"header-left"},be={key:1,class:"mfa-preview"},De={class:"card-header"},Pe={style:{"margin-top":"8px"}},ve={style:{margin:"8px 0 0 0","padding-left":"20px","line-height":"1.8"}},ke={class:"test-section"},Se={class:"card-header"},we={class:"header-left"},Ve={class:"button-group"},xe={class:"card-header"},Re={class:"header-left"},Ie={class:"button-group"};function Ue(o,e,S,A,l,p){const y=s("ChatDotRound"),m=s("el-icon"),c=s("el-button"),g=s("el-input"),C=s("el-form-item"),D=s("el-form"),v=s("el-card"),I=s("Bell"),P=s("Notification"),w=s("el-switch"),_=s("Calendar"),f=s("ChatLineRound"),r=s("el-link"),R=s("el-alert"),z=s("MessageBox"),M=s("Lock"),d=s("el-image"),T=s("el-col"),F=s("Promotion"),G=s("Key"),j=s("el-row");return b(),V("div",oe,[a(j,{gutter:20},{default:t(()=>[a(T,{xs:24,sm:24,md:14,lg:14},{default:t(()=>[n("div",se,[a(v,{shadow:"hover",class:"config-card"},{header:t(()=>[n("div",ne,[n("div",de,[a(m,{class:"header-icon",color:"#409EFF"},{default:t(()=>[a(y)]),_:1}),e[16]||(e[16]=n("span",{class:"card-title"},"Telegram 配置",-1))]),a(c,{type:"primary",size:"small",onClick:p.saveTelegramConfig,loading:l.loadingStates.telegram,icon:o.Select},{default:t(()=>e[17]||(e[17]=[i(" 保存 ")])),_:1},8,["onClick","loading","icon"])])]),default:t(()=>[a(D,{"label-position":"top"},{default:t(()=>[a(C,{label:"机器人 Token"},{default:t(()=>[a(g,{modelValue:l.UpdateSysCfgParams.tgBotToken,"onUpdate:modelValue":e[0]||(e[0]=h=>l.UpdateSysCfgParams.tgBotToken=h),placeholder:"请输入 Telegram Bot Token",clearable:"",type:"password","show-password":"",autocomplete:"new-password"},null,8,["modelValue"])]),_:1}),a(C,{label:"个人 ID"},{default:t(()=>[a(g,{modelValue:l.UpdateSysCfgParams.tgChatId,"onUpdate:modelValue":e[1]||(e[1]=h=>l.UpdateSysCfgParams.tgChatId=h),placeholder:"请输入 Telegram 个人 ID",clearable:"",type:"password","show-password":"",autocomplete:"new-password"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(v,{shadow:"hover",class:"config-card"},{header:t(()=>[n("div",ie,[n("div",re,[a(m,{class:"header-icon",color:"#67C23A"},{default:t(()=>[a(I)]),_:1}),e[18]||(e[18]=n("span",{class:"card-title"},"钉钉配置",-1))]),a(c,{type:"primary",size:"small",onClick:p.saveDingConfig,loading:l.loadingStates.ding,icon:o.Select},{default:t(()=>e[19]||(e[19]=[i(" 保存 ")])),_:1},8,["onClick","loading","icon"])])]),default:t(()=>[a(D,{"label-position":"top"},{default:t(()=>[a(C,{label:"Access Token"},{default:t(()=>[a(g,{modelValue:l.UpdateSysCfgParams.dingToken,"onUpdate:modelValue":e[2]||(e[2]=h=>l.UpdateSysCfgParams.dingToken=h),placeholder:"请输入钉钉 Access Token",clearable:"",type:"password","show-password":"",autocomplete:"new-password"},null,8,["modelValue"])]),_:1}),a(C,{label:"Secret"},{default:t(()=>[a(g,{modelValue:l.UpdateSysCfgParams.dingSecret,"onUpdate:modelValue":e[3]||(e[3]=h=>l.UpdateSysCfgParams.dingSecret=h),placeholder:"请输入钉钉 Secret",clearable:"",type:"password","show-password":"",autocomplete:"new-password"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(v,{shadow:"hover",class:"config-card"},{header:t(()=>[n("div",pe,[n("div",fe,[a(m,{class:"header-icon",color:"#E6A23C"},{default:t(()=>[a(P)]),_:1}),e[20]||(e[20]=n("span",{class:"card-title"},"版本更新通知配置",-1))])])]),default:t(()=>[a(D,{"label-position":"top"},{default:t(()=>[a(C,{label:"是否启用版本更新通知"},{default:t(()=>[a(w,{modelValue:l.UpdateSysCfgParams.enableVersionInform,"onUpdate:modelValue":e[4]||(e[4]=h=>l.UpdateSysCfgParams.enableVersionInform=h),"active-text":"启用","inactive-text":"禁用",onChange:p.saveVersionInformConfig},null,8,["modelValue","onChange"])]),_:1})]),_:1})]),_:1}),a(v,{shadow:"hover",class:"config-card"},{header:t(()=>[n("div",ce,[n("div",me,[a(m,{class:"header-icon",color:"#409EFF"},{default:t(()=>[a(_)]),_:1}),e[21]||(e[21]=n("span",{class:"card-title"},"每日播报配置",-1))]),a(c,{type:"primary",size:"small",onClick:p.saveDailyBroadcastConfig,loading:l.loadingStates.dailyBroadcast,icon:o.Select},{default:t(()=>e[22]||(e[22]=[i(" 保存 ")])),_:1},8,["onClick","loading","icon"])])]),default:t(()=>[a(D,{"label-position":"top"},{default:t(()=>[a(C,{label:"是否启用每日播报"},{default:t(()=>[a(w,{modelValue:l.UpdateSysCfgParams.enableDailyBroadcast,"onUpdate:modelValue":e[5]||(e[5]=h=>l.UpdateSysCfgParams.enableDailyBroadcast=h),"active-text":"启用","inactive-text":"禁用",onChange:p.saveDailyBroadcastConfig},null,8,["modelValue","onChange"])]),_:1}),a(C,{label:"定时任务cron表达式"},{default:t(()=>[a(g,{modelValue:l.UpdateSysCfgParams.dailyBroadcastCron,"onUpdate:modelValue":e[6]||(e[6]=h=>l.UpdateSysCfgParams.dailyBroadcastCron=h),placeholder:"例（每天早晨9点30分0秒）：0 30 9 * * ?",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(v,{shadow:"hover",class:"config-card"},{header:t(()=>[n("div",ue,[n("div",ge,[a(m,{class:"header-icon",color:"#9C27B0"},{default:t(()=>[a(f)]),_:1}),e[23]||(e[23]=n("span",{class:"card-title"},"AI聊天助手配置",-1))]),a(c,{type:"primary",size:"small",onClick:p.saveAiConfig,loading:l.loadingStates.ai,icon:o.Select},{default:t(()=>e[24]||(e[24]=[i(" 保存 ")])),_:1},8,["onClick","loading","icon"])])]),default:t(()=>[a(R,{title:"此AI助手基于硅基流动提供的免费API",type:"info",closable:!1,style:{"margin-bottom":"16px"}},{default:t(()=>[a(r,{type:"primary",underline:!1,href:"https://cloud.siliconflow.cn/me/account/ak",target:"_blank"},{default:t(()=>e[25]||(e[25]=[i(" 点击前往申请API秘钥 → ")])),_:1})]),_:1}),a(D,{"label-position":"top"},{default:t(()=>[a(C,{label:"API秘钥"},{default:t(()=>[a(g,{modelValue:l.UpdateSysCfgParams.gjAiApi,"onUpdate:modelValue":e[7]||(e[7]=h=>l.UpdateSysCfgParams.gjAiApi=h),placeholder:"请输入API秘钥，例：sk-a*******************************************wvxf",clearable:"","show-password":"",autocomplete:"new-password"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(v,{shadow:"hover",class:"config-card"},{header:t(()=>[n("div",Ce,[n("div",ye,[a(m,{class:"header-icon",color:"#F56C6C"},{default:t(()=>[a(z)]),_:1}),e[26]||(e[26]=n("span",{class:"card-title"},"放货播报配置",-1))]),a(c,{type:"primary",size:"small",onClick:p.saveBootBroadcastConfig,loading:l.loadingStates.bootBroadcast,icon:o.Select},{default:t(()=>e[27]||(e[27]=[i(" 保存 ")])),_:1},8,["onClick","loading","icon"])])]),default:t(()=>[a(R,{title:"此 Token 用于推送开机消息通知",type:"info",closable:!1,style:{"margin-bottom":"16px"}},{default:t(()=>[a(r,{type:"primary",underline:!1,href:"https://check.oci-helper.de5.net",target:"_blank"},{default:t(()=>e[28]||(e[28]=[i(" 点击前往查询放货播报面板 → ")])),_:1})]),_:1}),a(D,{"label-position":"top"},{default:t(()=>[a(C,{label:"开机消息推送Token"},{default:t(()=>[a(g,{type:"textarea",modelValue:l.UpdateSysCfgParams.bootBroadcastToken,"onUpdate:modelValue":e[8]||(e[8]=h=>l.UpdateSysCfgParams.bootBroadcastToken=h),placeholder:"请输入Token，例：eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzxxx.xxx",clearable:"","show-password":"",rows:5,resize:"none",autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(v,{shadow:"hover",class:"config-card"},{header:t(()=>[n("div",he,[n("div",_e,[a(m,{class:"header-icon",color:"#67C23A"},{default:t(()=>[a(M)]),_:1}),e[29]||(e[29]=n("span",{class:"card-title"},"MFA 配置",-1))])])]),default:t(()=>[a(D,{"label-position":"top"},{default:t(()=>[a(C,{label:"启用 MFA"},{default:t(()=>[a(w,{modelValue:l.UpdateSysCfgParams.enableMfa,"onUpdate:modelValue":e[9]||(e[9]=h=>l.UpdateSysCfgParams.enableMfa=h),"active-text":"启用","inactive-text":"禁用",onChange:p.saveMfaConfig},null,8,["modelValue","onChange"])]),_:1}),l.UpdateSysCfgParams.enableMfa?(b(),U(R,{key:0,title:"如果禁用后重新启用，请在 APP 上删除旧验证码并重新扫码绑定新验证码",type:"warning",closable:!1,style:{"margin-bottom":"16px"}})):x("",!0),l.UpdateSysCfgParams.enableMfa?(b(),V("div",be,[a(d,{src:l.UpdateSysCfgParams.mfaQrData,fit:"contain",style:{width:"200px",height:"200px","border-radius":"8px",border:"1px solid #dcdfe6"}},null,8,["src"]),a(g,{modelValue:l.UpdateSysCfgParams.mfaSecret,"onUpdate:modelValue":e[10]||(e[10]=h=>l.UpdateSysCfgParams.mfaSecret=h),style:{"margin-top":"16px"},disabled:"",readonly:""},null,8,["modelValue"])])):x("",!0)]),_:1})]),_:1}),a(v,{shadow:"hover",class:"config-card"},{header:t(()=>[n("div",De,[e[31]||(e[31]=n("div",{class:"header-left"},[n("svg",{class:"header-icon google-icon-header",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[n("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),n("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),n("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),n("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]),n("span",{class:"card-title"},"Google OAuth 配置")],-1)),a(c,{type:"primary",size:"small",onClick:p.saveGoogleConfig,loading:l.loadingStates.google,icon:o.Select},{default:t(()=>e[30]||(e[30]=[i(" 保存 ")])),_:1},8,["onClick","loading","icon"])])]),default:t(()=>[a(R,{title:"Google 一键登录配置",type:"info",closable:!1,style:{"margin-bottom":"16px"}},{default:t(()=>[n("div",Pe,[e[37]||(e[37]=n("div",null,"配置步骤：",-1)),n("ol",ve,[n("li",null,[a(r,{type:"primary",underline:!1,href:"https://console.cloud.google.com/",target:"_blank"},{default:t(()=>e[32]||(e[32]=[i(" 访问 Google Cloud Console → ")])),_:1})]),e[33]||(e[33]=n("li",null,"创建项目并启用 Google Sign-In API",-1)),e[34]||(e[34]=n("li",null,"创建 OAuth 2.0 客户端 ID（Web 应用）",-1)),e[35]||(e[35]=n("li",null,"配置授权 JavaScript 来源和重定向 URI",-1)),e[36]||(e[36]=n("li",null,"复制客户端 ID 并粘贴到下方输入框",-1))])])]),_:1}),a(D,{"label-position":"top"},{default:t(()=>[a(C,{label:"启用 Google 一键登录"},{default:t(()=>[a(w,{modelValue:l.UpdateSysCfgParams.enableGoogleLogin,"onUpdate:modelValue":e[11]||(e[11]=h=>l.UpdateSysCfgParams.enableGoogleLogin=h),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1}),l.UpdateSysCfgParams.enableGoogleLogin?(b(),U(C,{key:0,label:"Google Client ID"},{default:t(()=>[a(g,{modelValue:l.UpdateSysCfgParams.googleClientId,"onUpdate:modelValue":e[12]||(e[12]=h=>l.UpdateSysCfgParams.googleClientId=h),placeholder:"请输入 Google OAuth 2.0 Client ID，例：xxxxxx.apps.googleusercontent.com",clearable:"","show-password":"",autocomplete:"new-password"},null,8,["modelValue"])]),_:1})):x("",!0),l.UpdateSysCfgParams.enableGoogleLogin?(b(),U(C,{key:1,label:"允许登录的 Google 邮箱（必填）"},{default:t(()=>[a(g,{modelValue:l.UpdateSysCfgParams.allowedEmails,"onUpdate:modelValue":e[13]||(e[13]=h=>l.UpdateSysCfgParams.allowedEmails=h),placeholder:"例：user1@gmail.com,user2@company.com（必须配置至少一个完整邮箱）",clearable:"",type:"textarea",rows:3},null,8,["modelValue"]),e[38]||(e[38]=n("div",{style:{"margin-top":"8px",color:"#E6A23C","font-size":"13px"}},[i(" ⚠️ 必须配置至少一个完整邮箱地址，多个邮箱以逗号分隔"),n("br"),i(" 示例：user1@gmail.com,user2@gmail.com,admin@company.com ")],-1))]),_:1})):x("",!0)]),_:1})]),_:1})])]),_:1}),a(T,{xs:24,sm:24,md:10,lg:10},{default:t(()=>[n("div",ke,[a(v,{shadow:"hover",class:"config-card"},{header:t(()=>[n("div",Se,[n("div",we,[a(m,{class:"header-icon",color:"#409EFF"},{default:t(()=>[a(F)]),_:1}),e[39]||(e[39]=n("span",{class:"card-title"},"测试消息发送",-1))])])]),default:t(()=>[a(g,{type:"textarea",modelValue:l.message,"onUpdate:modelValue":e[14]||(e[14]=h=>l.message=h),placeholder:"请输入测试文本...",rows:10,resize:"none"},null,8,["modelValue"]),n("div",Ve,[a(c,{type:"primary",onClick:p.sendMsg,loading:l.sendLoading,icon:o.Promotion,style:{width:"100%"}},{default:t(()=>e[40]||(e[40]=[i(" 发送测试消息 ")])),_:1},8,["onClick","loading","icon"])])]),_:1}),a(v,{shadow:"hover",class:"config-card"},{header:t(()=>[n("div",xe,[n("div",Re,[a(m,{class:"header-icon",color:"#67C23A"},{default:t(()=>[a(G)]),_:1}),e[41]||(e[41]=n("span",{class:"card-title"},"测试MFA验证码",-1))])])]),default:t(()=>[a(g,{modelValue:l.mfaCode,"onUpdate:modelValue":e[15]||(e[15]=h=>l.mfaCode=h),clearable:"",placeholder:"请输入MFA验证码"},null,8,["modelValue"]),n("div",Ie,[a(c,{type:"primary",onClick:p.checkMfaCode,loading:l.sendMfaCodeLoading,icon:o.CircleCheck,style:{width:"100%"}},{default:t(()=>e[42]||(e[42]=[i(" 验证 ")])),_:1},8,["onClick","loading","icon"])])]),_:1})])]),_:1})]),_:1})])}const Ae=B(le,[["render",Ue],["__scopeId","data-v-263b0d76"]]),Le={components:{UploadFilled:$},data(){return{BackupParams:{enableEnc:!1,password:""},RecoverParams:{encryptionKey:"",fileList:[]},RecoverLoading:!1}},methods:{async handleBackup(){var o;if(this.BackupParams.enableEnc&&!((o=this.BackupParams.password)!=null&&o.trim())){u({message:"密钥不能为空",type:"error",duration:2e3});return}try{const e=await this.$axios.post("/sys/backup",{...this.BackupParams},{responseType:"blob"});let S="backup.zip";const A=e.headers["content-disposition"];if(A){const c=/filename\*?=(?:.*'')?(.+)/.exec(A);c&&c[1]&&(S=decodeURIComponent(c[1]))}const l=new Blob([e.data],{type:"application/octet-stream"}),p=window.URL.createObjectURL(l),y=document.createElement("a");y.href=p,y.download=S,y.click(),window.URL.revokeObjectURL(p),u({message:"备份文件已成功下载",type:"success",duration:2e3})}catch(e){console.error("Error during backup:",e),u({message:"备份失败，请重试",type:"error",duration:2e3})}},handleFileUpload({file:o}){const e=new FileReader;e.onload=S=>{S.target.result&&this.RecoverParams.fileList.push(o)},e.readAsArrayBuffer(o)},async handleRecover(){this.RecoverLoading=!0;const o=new FormData;o.append("encryptionKey",this.RecoverParams.encryptionKey),this.RecoverParams.fileList.forEach(e=>{o.append("fileList",e)}),await this.$axios.post("/sys/recover",o,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{e.data.success?(this.resetForm(),u({message:e.data.msg,type:"success",duration:2e3})):(this.RecoverLoading=!1,u({message:e.data.msg,type:"error",duration:2e3}))}).catch(e=>{console.error("Error:",e)}),this.resetForm()},resetForm(){this.BackupParams={enableEnc:!1,password:""},this.RecoverParams={encryptionKey:"",fileList:[]},this.RecoverLoading=!1}}};function Be(o,e,S,A,l,p){const y=s("el-switch"),m=s("el-form-item"),c=s("el-input"),g=s("el-button"),C=s("el-divider"),D=s("el-text"),v=s("upload-filled"),I=s("el-icon"),P=s("el-upload"),w=s("el-form");return b(),V("div",null,[a(w,null,{default:t(()=>[a(m,{label:"是否启用加密"},{default:t(()=>[a(y,{modelValue:l.BackupParams.enableEnc,"onUpdate:modelValue":e[0]||(e[0]=_=>l.BackupParams.enableEnc=_)},null,8,["modelValue"])]),_:1}),O(a(m,{label:"密钥"},{default:t(()=>[a(c,{modelValue:l.BackupParams.password,"onUpdate:modelValue":e[1]||(e[1]=_=>l.BackupParams.password=_),placeholder:"输入密钥",type:"password","show-password":"",clearable:"",style:{width:"400px"},autocomplete:"new-password"},null,8,["modelValue"])]),_:1},512),[[ee,l.BackupParams.enableEnc]]),a(m,null,{default:t(()=>[a(g,{type:"primary",onClick:p.handleBackup,style:{width:"430px"}},{default:t(()=>e[3]||(e[3]=[i("备份并下载")])),_:1},8,["onClick"])]),_:1}),a(C,{class:"divider"}),a(D,{class:"mx-1"},{default:t(()=>e[4]||(e[4]=[i("上传备份文件")])),_:1}),a(m,{label:"",style:{"margin-top":"10px"}},{default:t(()=>[a(P,{class:"upload-demo",drag:"","http-request":p.handleFileUpload,multiple:"","show-file-list":!0,"file-list":l.RecoverParams.fileList,style:{width:"400px"}},{tip:t(()=>e[5]||(e[5]=[n("div",{class:"el-upload__tip"}," ⭐请上传备份压缩包文件 ",-1)])),default:t(()=>[a(I,{class:"el-icon--upload"},{default:t(()=>[a(v)]),_:1}),e[6]||(e[6]=n("div",{class:"el-upload__text"},[i(" Drop file here or "),n("em",null,"click to upload")],-1))]),_:1},8,["http-request","file-list"])]),_:1}),a(m,{label:"密钥"},{default:t(()=>[a(c,{modelValue:l.RecoverParams.encryptionKey,"onUpdate:modelValue":e[2]||(e[2]=_=>l.RecoverParams.encryptionKey=_),placeholder:"输入密钥（可选）",clearable:"",style:{width:"400px"},type:"password","show-password":"",autocomplete:"new-password"},null,8,["modelValue"])]),_:1}),a(m,null,{default:t(()=>[a(g,{type:"primary",onClick:p.handleRecover,style:{width:"430px"},loading:l.RecoverLoading},{default:t(()=>e[7]||(e[7]=[i("恢复数据 ")])),_:1},8,["onClick","loading"])]),_:1})]),_:1})])}const ze=B(Le,[["render",Be],["__scopeId","data-v-89035c90"]]),Te={props:{cfCfgId:String,cfCfgName:String},mounted(){this.pageParams.cfCfgId=this.cfCfgId,this.getCfDnsRecords()},data(){return{loading:!0,addDnsRecordDialog:!1,addDnsRecordLoading:!1,updateDnsRecordDialog:!1,updateDnsRecordLoading:!1,pageParams:{cfCfgId:"",keyword:"",currentPage:1,pageSize:10,cleanReLaunch:!1},cfDnsRecordsPageRsp:[{id:"",name:"",type:"",content:"",proxiable:null,proxied:null,ttl:null,comment:"",createdOn:"",modifiedOn:"",tags:[]}],total:0,batchSelected:[],removeIds:[],OciAddCfDnsRecordsParams:{cfCfgId:"",prefix:"",type:"",ipAddress:"",proxied:!1,ttl:60,comment:""},OciUpdateCfDnsRecordsParams:{cfCfgId:"",id:"",prefix:"",type:"",ipAddress:"",proxied:!1,ttl:60,comment:""}}},methods:{async reloadCfDnsRecords(){this.pageParams.cleanReLaunch=!0,this.loading=!0,this.getCfDnsRecords(),this.pageParams.cleanReLaunch=!1},async getCfDnsRecords(){this.loading=!0,await this.$axios.post("/cf/listCfDnsRecord",{...this.pageParams}).then(o=>{o.data.success?(this.cfDnsRecordsPageRsp=o.data.data.records,this.total=o.data.data.total):u({message:o.data.msg,type:"error",duration:2e3})}).catch(o=>{console.error("Error:",o)}).finally(()=>{this.cleanCache()})},async batchRemove(){if(!await L("确定要删除 DNS 记录吗？","删除 Cloudflare DNS 记录")){this.$message.info("已取消");return}this.loading=!0,this.removeIds=this.batchSelected.map(e=>e.id),await this.$axios.post("/cf/removeCfDnsRecord",{recordIds:this.removeIds,cfCfgId:this.cfCfgId}).then(e=>{e.data.success?u({message:"删除 Cloudflare DNS 记录成功",type:"success",duration:2e3}):u({message:e.data.msg,type:"error",duration:2e3}),this.reloadCfDnsRecords()}).catch(e=>{console.error("Error:",e)})},async addCfDnsRecords(){if(!await L("确定要新增 DNS 记录吗？","新增 Cloudflare DNS 记录")){this.$message.info("已取消");return}this.OciAddCfDnsRecordsParams.cfCfgId=this.cfCfgId,this.addDnsRecordLoading=!0,await this.$axios.post("/cf/addCfDnsRecord",{...this.OciAddCfDnsRecordsParams}).then(e=>{e.data.success?u({message:"新增 Cloudflare DNS 记录成功",type:"success",duration:2e3}):u({message:e.data.msg,type:"error",duration:2e3}),this.reloadCfDnsRecords()}).catch(e=>{console.error("Error:",e)})},async updateCfDnsRecord(){if(!await L("确定要更新 DNS 记录吗？","更新 Cloudflare DNS 记录")){this.$message.info("已取消");return}this.OciUpdateCfDnsRecordsParams.cfCfgId=this.cfCfgId,this.updateDnsRecordLoading=!0,await this.$axios.post("/cf/updateCfDnsRecord",{...this.OciUpdateCfDnsRecordsParams}).then(e=>{e.data.success?u({message:"更新 Cloudflare DNS 记录成功",type:"success",duration:2e3}):u({message:e.data.msg,type:"error",duration:2e3}),this.reloadCfDnsRecords()}).catch(e=>{console.error("Error:",e)})},handleUpdateDns(o){this.OciUpdateCfDnsRecordsParams.id=o.id,this.OciUpdateCfDnsRecordsParams.type=o.type,this.OciUpdateCfDnsRecordsParams.ipAddress=o.content,this.OciUpdateCfDnsRecordsParams.proxied=o.proxied,this.OciUpdateCfDnsRecordsParams.ttl=o.ttl,this.OciUpdateCfDnsRecordsParams.comment=o.comment;const e=o.name;if(e.endsWith(this.cfCfgName)){const S="."+this.cfCfgName;this.OciUpdateCfDnsRecordsParams.prefix=e.slice(0,-S.length)}this.updateDnsRecordDialog=!0},cleanCache(){this.batchSelected=[],this.loading=!1,this.addDnsRecordLoading=!1,this.addDnsRecordDialog=!1,this.updateDnsRecordLoading=!1,this.updateDnsRecordDialog=!1,this.OciAddCfDnsRecordsParams={},this.OciUpdateCfDnsRecordsParams={}},handleRemove(o){this.batchSelected.push(o),this.batchRemove()},handlePageChange(o){this.pageParams.currentPage=o,this.getCfDnsRecords()},handleSizeChange(o){this.pageParams.currentPage=1,this.pageParams.pageSize=o,this.getCfDnsRecords()},handleSelectionChange(o){this.batchSelected=o}}},Oe={style:{"font-size":"16px","font-weight":"bold","margin-left":"20px"}},Me={style:{"overflow-x":"auto"}},Ee={class:"dialog-footer"},Ne={class:"dialog-footer"};function Fe(o,e,S,A,l,p){const y=s("el-divider"),m=s("el-button"),c=s("el-input"),g=s("el-table-column"),C=s("el-tag"),D=s("el-tooltip"),v=s("el-table"),I=s("el-pagination"),P=s("el-option"),w=s("el-select"),_=s("el-form-item"),f=s("el-switch"),r=s("el-input-number"),R=s("el-form"),z=s("el-dialog"),M=E("loading");return b(),V(N,null,[n("span",Oe,"当前配置："+k(this.cfCfgName),1),a(y,{class:"divider"}),a(m,{type:"success",style:{"margin-bottom":"20px"},onClick:p.reloadCfDnsRecords},{default:t(()=>e[24]||(e[24]=[i(" 刷新 ")])),_:1},8,["onClick"]),a(c,{modelValue:l.pageParams.keyword,"onUpdate:modelValue":e[0]||(e[0]=d=>l.pageParams.keyword=d),placeholder:"模糊搜索",onInput:p.getCfDnsRecords,clearable:"","prefix-icon":"Search",style:{"margin-left":"20px",width:"400px","margin-bottom":"20px"}},null,8,["modelValue","onInput"]),a(m,{type:"primary",onClick:e[1]||(e[1]=d=>l.addDnsRecordDialog=!0),style:{"margin-left":"20px","margin-bottom":"20px"}},{default:t(()=>e[25]||(e[25]=[i(" 新增 DNS 记录 ")])),_:1}),a(m,{type:"danger",onClick:p.batchRemove,disabled:!l.batchSelected.length,style:{"margin-left":"20px","margin-bottom":"20px"}},{default:t(()=>e[26]||(e[26]=[i(" 批量删除 ")])),_:1},8,["onClick","disabled"]),n("div",Me,[O((b(),U(v,{data:l.cfDnsRecordsPageRsp,style:{width:"100%","min-width":"800px"},onSelectionChange:p.handleSelectionChange},{default:t(()=>[a(g,{type:"selection",width:"35"}),a(g,{label:"域名",width:"300"},{default:t(({row:d})=>[a(D,{content:d.name,placement:"top"},{default:t(()=>[a(C,{type:"success"},{default:t(()=>[i(k(d.name),1)]),_:2},1024)]),_:2},1032,["content"])]),_:1}),a(g,{label:"类型",width:"100"},{default:t(({row:d})=>[i(k(d.type),1)]),_:1}),a(g,{label:"内容",width:"300"},{default:t(({row:d})=>[a(D,{content:d.content,placement:"top"},{default:t(()=>[i(k(d.content),1)]),_:2},1032,["content"])]),_:1}),a(g,{label:"开启CDN",width:"100"},{default:t(({row:d})=>[a(D,{content:d.proxied===!0?"是":"否",placement:"top"},{default:t(()=>[a(C,{type:d.proxied===!0?"success":"info"},{default:t(()=>[i(k(d.proxied===!0?"是":"否"),1)]),_:2},1032,["type"])]),_:2},1032,["content"])]),_:1}),a(g,{label:"TTL（秒）",width:"100"},{default:t(({row:d})=>[i(k(d.ttl===1?"自动":d.ttl),1)]),_:1}),a(g,{label:"备注"},{default:t(({row:d})=>[a(D,{content:d.comment,placement:"top"},{default:t(()=>[i(k(d.comment),1)]),_:2},1032,["content"])]),_:1}),a(g,{label:"创建时间"},{default:t(({row:d})=>[a(D,{content:d.createdOn,placement:"top"},{default:t(()=>[a(C,{type:"info"},{default:t(()=>[i(k(d.createdOn),1)]),_:2},1024)]),_:2},1032,["content"])]),_:1}),a(g,{label:"操作",width:"220"},{default:t(({row:d})=>[a(m,{onClick:T=>p.handleUpdateDns(d),type:"primary",link:""},{default:t(()=>e[27]||(e[27]=[i(" 编辑 ")])),_:2},1032,["onClick"]),a(m,{onClick:T=>p.handleRemove(d),type:"danger",link:""},{default:t(()=>e[28]||(e[28]=[i(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSelectionChange"])),[[M,l.loading]]),a(I,{onCurrentChange:p.handlePageChange,onSizeChange:p.handleSizeChange,"current-page":l.pageParams.currentPage,"onUpdate:currentPage":e[2]||(e[2]=d=>l.pageParams.currentPage=d),"page-size":l.pageParams.pageSize,"onUpdate:pageSize":e[3]||(e[3]=d=>l.pageParams.pageSize=d),"page-sizes":[5,10,20,50],total:l.total,layout:"total, sizes, prev, pager, next, jumper",style:{"margin-top":"20px"}},null,8,["onCurrentChange","onSizeChange","current-page","page-size","total"])]),a(z,{modelValue:l.addDnsRecordDialog,"onUpdate:modelValue":e[12]||(e[12]=d=>l.addDnsRecordDialog=d),title:"新增 Cloudflare DNS 记录",width:"40%",onClose:e[13]||(e[13]=d=>l.addDnsRecordDialog=!1)},{footer:t(()=>[n("div",Ee,[a(m,{type:"info",onClick:e[11]||(e[11]=d=>l.addDnsRecordDialog=!1)},{default:t(()=>e[29]||(e[29]=[i("取消")])),_:1}),a(m,{type:"primary",onClick:p.addCfDnsRecords,loading:l.addDnsRecordLoading},{default:t(()=>e[30]||(e[30]=[i(" 新增 ")])),_:1},8,["onClick","loading"])])]),default:t(()=>[a(R,{"label-width":"100px"},{default:t(()=>[a(_,{label:"记录类型"},{default:t(()=>[a(w,{modelValue:l.OciAddCfDnsRecordsParams.type,"onUpdate:modelValue":e[4]||(e[4]=d=>l.OciAddCfDnsRecordsParams.type=d),placeholder:"请选择记录类型"},{default:t(()=>[a(P,{label:"A (IPv4)",value:"A"}),a(P,{label:"AAAA (IPv6)",value:"AAAA"}),a(P,{label:"CNAME (别名)",value:"CNAME"})]),_:1},8,["modelValue"])]),_:1}),a(_,{label:"域名前缀"},{default:t(()=>[a(c,{modelValue:l.OciAddCfDnsRecordsParams.prefix,"onUpdate:modelValue":e[5]||(e[5]=d=>l.OciAddCfDnsRecordsParams.prefix=d),placeholder:"请输入域名前缀，例如 oracle-kr",clearable:""},null,8,["modelValue"])]),_:1}),l.OciAddCfDnsRecordsParams.type==="A"||l.OciAddCfDnsRecordsParams.type==="AAAA"?(b(),U(_,{key:0,label:"IP 地址"},{default:t(()=>[a(c,{modelValue:l.OciAddCfDnsRecordsParams.ipAddress,"onUpdate:modelValue":e[6]||(e[6]=d=>l.OciAddCfDnsRecordsParams.ipAddress=d),placeholder:"请输入 IP 地址",clearable:""},null,8,["modelValue"])]),_:1})):x("",!0),l.OciAddCfDnsRecordsParams.type==="CNAME"?(b(),U(_,{key:1,label:"目标域名"},{default:t(()=>[a(c,{modelValue:l.OciAddCfDnsRecordsParams.ipAddress,"onUpdate:modelValue":e[7]||(e[7]=d=>l.OciAddCfDnsRecordsParams.ipAddress=d),placeholder:"请输入目标域名，例如 target.example.com",clearable:""},null,8,["modelValue"])]),_:1})):x("",!0),a(_,{label:"代理加速"},{default:t(()=>[a(f,{modelValue:l.OciAddCfDnsRecordsParams.proxied,"onUpdate:modelValue":e[8]||(e[8]=d=>l.OciAddCfDnsRecordsParams.proxied=d),"active-text":"开启","inactive-text":"关闭"},null,8,["modelValue"])]),_:1}),a(_,{label:"TTL（秒）"},{default:t(()=>[a(r,{modelValue:l.OciAddCfDnsRecordsParams.ttl,"onUpdate:modelValue":e[9]||(e[9]=d=>l.OciAddCfDnsRecordsParams.ttl=d),min:60,step:60,placeholder:"TTL 秒数"},null,8,["modelValue"])]),_:1}),a(_,{label:"备注"},{default:t(()=>[a(c,{type:"textarea",modelValue:l.OciAddCfDnsRecordsParams.comment,"onUpdate:modelValue":e[10]||(e[10]=d=>l.OciAddCfDnsRecordsParams.comment=d),placeholder:"可填写备注",rows:"2",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(z,{modelValue:l.updateDnsRecordDialog,"onUpdate:modelValue":e[22]||(e[22]=d=>l.updateDnsRecordDialog=d),title:"更新 Cloudflare DNS 记录",width:"40%",onClose:e[23]||(e[23]=d=>l.updateDnsRecordDialog=!1)},{footer:t(()=>[n("div",Ne,[a(m,{type:"info",onClick:e[21]||(e[21]=d=>l.updateDnsRecordDialog=!1)},{default:t(()=>e[31]||(e[31]=[i("取消")])),_:1}),a(m,{type:"primary",onClick:p.updateCfDnsRecord,loading:l.updateDnsRecordLoading},{default:t(()=>e[32]||(e[32]=[i(" 更新 ")])),_:1},8,["onClick","loading"])])]),default:t(()=>[a(R,{"label-width":"100px"},{default:t(()=>[a(_,{label:"记录类型"},{default:t(()=>[a(w,{modelValue:l.OciUpdateCfDnsRecordsParams.type,"onUpdate:modelValue":e[14]||(e[14]=d=>l.OciUpdateCfDnsRecordsParams.type=d),placeholder:"请选择记录类型",disabled:""},{default:t(()=>[a(P,{label:"A (IPv4)",value:"A"}),a(P,{label:"AAAA (IPv6)",value:"AAAA"}),a(P,{label:"CNAME (别名)",value:"CNAME"})]),_:1},8,["modelValue"])]),_:1}),a(_,{label:"域名前缀"},{default:t(()=>[a(c,{modelValue:l.OciUpdateCfDnsRecordsParams.prefix,"onUpdate:modelValue":e[15]||(e[15]=d=>l.OciUpdateCfDnsRecordsParams.prefix=d),placeholder:"请输入域名前缀",clearable:""},null,8,["modelValue"])]),_:1}),l.OciUpdateCfDnsRecordsParams.type==="A"||l.OciUpdateCfDnsRecordsParams.type==="AAAA"?(b(),U(_,{key:0,label:"IP 地址"},{default:t(()=>[a(c,{modelValue:l.OciUpdateCfDnsRecordsParams.ipAddress,"onUpdate:modelValue":e[16]||(e[16]=d=>l.OciUpdateCfDnsRecordsParams.ipAddress=d),placeholder:"请输入 IP 地址",clearable:""},null,8,["modelValue"])]),_:1})):x("",!0),l.OciUpdateCfDnsRecordsParams.type==="CNAME"?(b(),U(_,{key:1,label:"目标域名"},{default:t(()=>[a(c,{modelValue:l.OciUpdateCfDnsRecordsParams.ipAddress,"onUpdate:modelValue":e[17]||(e[17]=d=>l.OciUpdateCfDnsRecordsParams.ipAddress=d),placeholder:"请输入目标域名",clearable:""},null,8,["modelValue"])]),_:1})):x("",!0),a(_,{label:"代理加速"},{default:t(()=>[a(f,{modelValue:l.OciUpdateCfDnsRecordsParams.proxied,"onUpdate:modelValue":e[18]||(e[18]=d=>l.OciUpdateCfDnsRecordsParams.proxied=d),"active-text":"开启","inactive-text":"关闭"},null,8,["modelValue"])]),_:1}),a(_,{label:"TTL（秒）"},{default:t(()=>[a(r,{modelValue:l.OciUpdateCfDnsRecordsParams.ttl,"onUpdate:modelValue":e[19]||(e[19]=d=>l.OciUpdateCfDnsRecordsParams.ttl=d),min:60,step:60,placeholder:"TTL 秒数"},null,8,["modelValue"])]),_:1}),a(_,{label:"备注"},{default:t(()=>[a(c,{type:"textarea",modelValue:l.OciUpdateCfDnsRecordsParams.comment,"onUpdate:modelValue":e[20]||(e[20]=d=>l.OciUpdateCfDnsRecordsParams.comment=d),placeholder:"备注信息",rows:"2",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}const Ge=B(Te,[["render",Fe],["__scopeId","data-v-02cda709"]]),je={components:{CloudflareDnsRecords:Ge},mounted(){this.getCfCfgList()},data(){return{addCfCfgDialog:!1,addCfCfgLoading:!1,updateCfCfgDialog:!1,updateCfCfgLoading:!1,showCfDnsRecords:!1,cfCfgId:null,cfCfgName:"",loading:!0,pageParams:{keyword:"",currentPage:1,pageSize:10},cfCfgPageRsp:[{id:"",domain:"",zoneId:"",apiToken:"",createTime:""}],total:0,batchSelected:[],removeIds:[],AddCfCfgParams:{domain:"",zoneId:"",apiToken:""},UpdateCfCfgParams:{id:"",domain:"",zoneId:"",apiToken:""}}},methods:{async getCfCfgList(){this.loading=!0,await this.$axios.post("/cf/listCfg",{...this.pageParams}).then(o=>{o.data.success?(this.cfCfgPageRsp=o.data.data.records,this.total=o.data.data.total):u({message:o.data.msg,type:"error",duration:2e3})}).catch(o=>{console.error("Error:",o)}).finally(()=>{this.cleanCache()})},async batchRemove(){if(!await L("确定要删除配置吗？","删除 Cloudflare 配置")){this.$message.info("已取消");return}this.loading=!0,this.removeIds=this.batchSelected.map(e=>e.id),await this.$axios.post("/cf/removeBatch",{idList:this.removeIds}).then(e=>{e.data.success?u({message:"删除 Cloudflare 配置成功",type:"success",duration:2e3}):u({message:e.data.msg,type:"error",duration:2e3}),this.getCfCfgList()}).catch(e=>{console.error("Error:",e)})},async addCfCfg(){if(!await L("确定要新增配置吗？","新增 Cloudflare 配置")){this.$message.info("已取消");return}this.addCfCfgLoading=!0,await this.$axios.post("/cf/add",{...this.AddCfCfgParams}).then(e=>{e.data.success?(u({message:"新增 Cloudflare 配置成功",type:"success",duration:2e3}),this.addCfCfgDialog=!1):u({message:e.data.msg,type:"error",duration:2e3}),this.getCfCfgList()}).catch(e=>{console.error("Error:",e)})},async updateCfCfg(){if(!await L("确定要修改配置吗？","修改 Cloudflare 配置")){this.$message.info("已取消");return}this.updateCfCfgLoading=!0,await this.$axios.post("/cf/update",{...this.UpdateCfCfgParams}).then(e=>{e.data.success?(u({message:"修改 Cloudflare 配置成功",type:"success",duration:2e3}),this.updateCfCfgDialog=!1):u({message:e.data.msg,type:"error",duration:2e3}),this.getCfCfgList()}).catch(e=>{console.error("Error:",e)})},handleUpdateCfCfg(o){this.UpdateCfCfgParams.id=o.id,this.UpdateCfCfgParams.domain=o.domain,this.UpdateCfCfgParams.zoneId=o.zoneId,this.UpdateCfCfgParams.apiToken=o.apiToken,this.updateCfCfgDialog=!0},cleanCache(){this.batchSelected=[],this.AddCfCfgParams={},this.loading=!1,this.addCfCfgLoading=!1,this.updateCfCfgLoading=!1},handleRemove(o){this.batchSelected.push(o),this.batchRemove()},handleCfDnsRecords(o){this.cfCfgId=o.id,this.cfCfgName=o.domain,this.showCfDnsRecords=!0},handlePageChange(o){this.pageParams.currentPage=o,this.getCfCfgList()},handleSizeChange(o){this.pageParams.currentPage=1,this.pageParams.pageSize=o,this.getCfCfgList()},handleSelectionChange(o){this.batchSelected=o}}},Ke={key:0},Je={style:{"overflow-x":"auto"}},Qe={key:1},qe={class:"dialog-footer"},He={class:"dialog-footer"};function We(o,e,S,A,l,p){const y=s("el-button"),m=s("el-input"),c=s("el-table-column"),g=s("el-tag"),C=s("el-tooltip"),D=s("el-table"),v=s("el-pagination"),I=s("CloudflareDnsRecords"),P=s("el-form-item"),w=s("el-form"),_=s("el-dialog"),f=E("loading");return b(),V(N,null,[n("div",null,[l.showCfDnsRecords?(b(),V("div",Qe,[a(y,{onClick:e[4]||(e[4]=r=>l.showCfDnsRecords=!1)},{default:t(()=>e[25]||(e[25]=[i("返回 Cloudflare 配置列表")])),_:1}),a(I,{cfCfgId:l.cfCfgId,cfCfgName:l.cfCfgName},null,8,["cfCfgId","cfCfgName"])])):(b(),V("div",Ke,[a(y,{type:"success",style:{"margin-bottom":"20px"},onClick:p.getCfCfgList},{default:t(()=>e[19]||(e[19]=[i(" 刷新 ")])),_:1},8,["onClick"]),a(m,{modelValue:l.pageParams.keyword,"onUpdate:modelValue":e[0]||(e[0]=r=>l.pageParams.keyword=r),placeholder:"模糊搜索",onInput:p.getCfCfgList,clearable:"","prefix-icon":"Search",style:{"margin-left":"20px",width:"400px","margin-bottom":"20px"}},null,8,["modelValue","onInput"]),a(y,{type:"primary",onClick:e[1]||(e[1]=r=>l.addCfCfgDialog=!0),style:{"margin-left":"20px","margin-bottom":"20px"}},{default:t(()=>e[20]||(e[20]=[i(" 新增配置 ")])),_:1}),a(y,{type:"danger",onClick:p.batchRemove,disabled:!l.batchSelected.length,style:{"margin-left":"20px","margin-bottom":"20px"}},{default:t(()=>e[21]||(e[21]=[i(" 批量删除 ")])),_:1},8,["onClick","disabled"]),n("div",Je,[O((b(),U(D,{data:l.cfCfgPageRsp,style:{width:"100%","min-width":"800px"},onSelectionChange:p.handleSelectionChange},{default:t(()=>[a(c,{type:"selection",width:"35"}),a(c,{label:"域名",width:"300"},{default:t(({row:r})=>[a(C,{content:r.domain,placement:"top"},{default:t(()=>[a(g,{type:"success"},{default:t(()=>[i(k(r.domain),1)]),_:2},1024)]),_:2},1032,["content"])]),_:1}),a(c,{label:"ZoneId",width:"350"},{default:t(({row:r})=>[a(C,{content:r.zoneId,placement:"top"},{default:t(()=>[i(k(r.zoneId),1)]),_:2},1032,["content"])]),_:1}),a(c,{label:"Token",width:"400"},{default:t(({row:r})=>[a(C,{content:r.apiToken,placement:"top"},{default:t(()=>[i(k(r.apiToken),1)]),_:2},1032,["content"])]),_:1}),a(c,{label:"创建时间"},{default:t(({row:r})=>[a(C,{content:r.createTime,placement:"top"},{default:t(()=>[a(g,{type:"info"},{default:t(()=>[i(k(r.createTime),1)]),_:2},1024)]),_:2},1032,["content"])]),_:1}),a(c,{label:"操作",width:"220"},{default:t(({row:r})=>[a(y,{onClick:R=>p.handleUpdateCfCfg(r),type:"primary",link:""},{default:t(()=>e[22]||(e[22]=[i(" 编辑 ")])),_:2},1032,["onClick"]),a(y,{onClick:R=>p.handleCfDnsRecords(r),type:"success",link:""},{default:t(()=>e[23]||(e[23]=[i(" DNS记录 ")])),_:2},1032,["onClick"]),a(y,{onClick:R=>p.handleRemove(r),type:"danger",link:""},{default:t(()=>e[24]||(e[24]=[i(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSelectionChange"])),[[f,l.loading]])]),a(v,{onCurrentChange:p.handlePageChange,onSizeChange:p.handleSizeChange,"current-page":l.pageParams.currentPage,"onUpdate:currentPage":e[2]||(e[2]=r=>l.pageParams.currentPage=r),"page-size":l.pageParams.pageSize,"onUpdate:pageSize":e[3]||(e[3]=r=>l.pageParams.pageSize=r),"page-sizes":[5,10,20,50],total:l.total,layout:"total, sizes, prev, pager, next, jumper",style:{"margin-top":"20px"}},null,8,["onCurrentChange","onSizeChange","current-page","page-size","total"])]))]),a(_,{modelValue:l.addCfCfgDialog,"onUpdate:modelValue":e[10]||(e[10]=r=>l.addCfCfgDialog=r),title:"新增 Cloudflare 配置名称",width:"40%",onClose:e[11]||(e[11]=r=>l.addCfCfgDialog=!1)},{footer:t(()=>[n("div",qe,[a(y,{type:"info",onClick:e[8]||(e[8]=r=>l.addCfCfgDialog=!1)},{default:t(()=>e[26]||(e[26]=[i("取消")])),_:1}),a(y,{type:"primary",onClick:e[9]||(e[9]=r=>p.addCfCfg()),loading:l.addCfCfgLoading},{default:t(()=>e[27]||(e[27]=[i("新增")])),_:1},8,["loading"])])]),default:t(()=>[a(w,{"label-width":"100px"},{default:t(()=>[a(P,{label:"域名","label-width":"130"},{default:t(()=>[a(m,{class:"cf-input",modelValue:l.AddCfCfgParams.domain,"onUpdate:modelValue":e[5]||(e[5]=r=>l.AddCfCfgParams.domain=r),placeholder:"请输入托管于 Cloudflare 的域名，例：abc.xyz",clearable:"",autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(P,{label:"区域ID (ZoneId)","label-width":"130"},{default:t(()=>[a(m,{class:"cf-input",modelValue:l.AddCfCfgParams.zoneId,"onUpdate:modelValue":e[6]||(e[6]=r=>l.AddCfCfgParams.zoneId=r),placeholder:"请输入托管于 Cloudflare 的域名的区域ID",clearable:"",autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(P,{label:"API令牌 (Token)","label-width":"130"},{default:t(()=>[a(m,{class:"cf-input",modelValue:l.AddCfCfgParams.apiToken,"onUpdate:modelValue":e[7]||(e[7]=r=>l.AddCfCfgParams.apiToken=r),placeholder:"请输入托管于 Cloudflare 的域名的 API令牌（需要自行生成）",clearable:"",autocomplete:"new-password"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(_,{modelValue:l.updateCfCfgDialog,"onUpdate:modelValue":e[17]||(e[17]=r=>l.updateCfCfgDialog=r),title:"修改 Cloudflare 配置名称",width:"40%",onClose:e[18]||(e[18]=r=>l.updateCfCfgDialog=!1)},{footer:t(()=>[n("div",He,[a(y,{type:"info",onClick:e[15]||(e[15]=r=>l.updateCfCfgDialog=!1)},{default:t(()=>e[28]||(e[28]=[i("取消")])),_:1}),a(y,{type:"primary",onClick:e[16]||(e[16]=r=>p.updateCfCfg()),loading:l.updateCfCfgLoading},{default:t(()=>e[29]||(e[29]=[i("修改")])),_:1},8,["loading"])])]),default:t(()=>[a(w,{"label-width":"100px"},{default:t(()=>[a(P,{label:"域名","label-width":"130"},{default:t(()=>[a(m,{class:"cf-input",modelValue:l.UpdateCfCfgParams.domain,"onUpdate:modelValue":e[12]||(e[12]=r=>l.UpdateCfCfgParams.domain=r),placeholder:"请输入托管于 Cloudflare 的域名，例：abc.xyz",clearable:"",autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(P,{label:"区域ID (ZoneId)","label-width":"130"},{default:t(()=>[a(m,{class:"cf-input",modelValue:l.UpdateCfCfgParams.zoneId,"onUpdate:modelValue":e[13]||(e[13]=r=>l.UpdateCfCfgParams.zoneId=r),placeholder:"请输入托管于 Cloudflare 的域名的区域ID",clearable:"",autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(P,{label:"API令牌 (Token)","label-width":"130"},{default:t(()=>[a(m,{class:"cf-input",modelValue:l.UpdateCfCfgParams.apiToken,"onUpdate:modelValue":e[14]||(e[14]=r=>l.UpdateCfCfgParams.apiToken=r),placeholder:"请输入托管于 Cloudflare 的域名的 API令牌（需要自行生成）",clearable:"",autocomplete:"new-password"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}const Ze=B(je,[["render",We],["__scopeId","data-v-82e2a950"]]),Xe={components:{},mounted(){this.getMapDataList()},data(){return{addMapData:!1,addIpDataLoading:!1,removeIpDataLoading:!1,updateIpDataLoading:!1,loading:!0,pageParams:{keyword:"",currentPage:1,pageSize:10},addIpDataParams:{ip:""},mapDataPageRsp:[{id:"1",ip:"1.1.1.1",country:"AU",area:"New South Wales",city:"Sydney",org:"CLOUDFLARENET",asn:"AS13335",lat:-33.859336,lng:151.203624,createTime:"2025-07-30 15:08:47"}],total:0,batchSelected:[],removeIds:[]}},methods:{copyToClipboard:ae,async getMapDataList(){this.loading=!0,await this.$axios.post("/ipData/page",{...this.pageParams}).then(o=>{o.data.success?(this.mapDataPageRsp=o.data.data.records,this.total=o.data.data.total,u({message:"获取IP数据列表成功",type:"success",duration:2e3})):u({message:o.data.msg,type:"error",duration:2e3})}).catch(o=>{console.error("Error:",o)}).finally(()=>{this.cleanCache()})},async addIpData(){this.addIpDataLoading=!0,await this.$axios.post("/ipData/add",{...this.addIpDataParams}).then(o=>{o.data.success?u({message:"新增IP数据成功",type:"success",duration:2e3}):u({message:o.data.msg,type:"error",duration:2e3})}).catch(o=>{console.error("Error:",o)}).finally(()=>{this.cleanCache(),this.getMapDataList()})},async updateOciCfgIpData(){if(!await L("确定要同步所有已存在的oci配置的最新IP数据吗？","同步已有的oci配置的IP信息")){this.$message.info("已取消");return}this.loading=!0,this.$axios.post("/ipData/loadOciIpData",{}).then(e=>{e.data.success?u({message:"同步IP数据任务下发成功，请稍后自行刷新列表查看",type:"success",duration:2e3}):u({message:e.data.msg,type:"error",duration:2e3})}).catch(e=>{console.error("Error:",e)}).finally(()=>{this.cleanCache(),this.getMapDataList()})},async batchRemove(){if(!await L("确定要删除IP数据吗？","删除首页地图IP数据")){this.$message.info("已取消");return}this.removeIpDataLoading=!0,this.removeIds=this.batchSelected.map(e=>e.id),await this.$axios.post("/ipData/remove",{idList:this.removeIds}).then(e=>{e.data.success?u({message:"删除IP数据成功",type:"success",duration:2e3}):u({message:e.data.msg,type:"error",duration:2e3})}).catch(e=>{console.error("Error:",e)}).finally(()=>{this.cleanCache(),this.getMapDataList()})},async updateIpInfo(o){if(!await L("确定要更新IP："+o.ip+" 的数据信息吗？","更新IP数据")){this.$message.info("已取消");return}this.updateIpDataLoading=!0,await this.$axios.post("/ipData/update",{id:o.id}).then(S=>{S.data.success?u({message:"更新IP数据成功",type:"success",duration:2e3}):u({message:S.data.msg,type:"error",duration:2e3})}).catch(S=>{console.error("Error:",S)}).finally(()=>{this.cleanCache(),this.getMapDataList()})},cleanCache(){this.batchSelected=[],this.removeIds=[],this.loading=!1,this.addIpDataLoading=!1,this.removeIpDataLoading=!1,this.updateIpDataLoading=!1,this.addMapData=!1,this.addIpDataParams.ip=""},handleRemove(o){this.batchSelected.push(o),this.batchRemove()},handlePageChange(o){this.pageParams.currentPage=o,this.getMapDataList()},handleSizeChange(o){this.pageParams.currentPage=1,this.pageParams.pageSize=o,this.getMapDataList()},handleSelectionChange(o){this.batchSelected=o}}},Ye={style:{"overflow-x":"auto"}},$e={class:"dialog-footer"};function ea(o,e,S,A,l,p){const y=s("el-button"),m=s("el-input"),c=s("el-table-column"),g=s("el-tag"),C=s("el-tooltip"),D=s("el-table"),v=s("el-pagination"),I=s("el-form-item"),P=s("el-form"),w=s("el-dialog"),_=E("loading");return b(),V(N,null,[n("div",null,[a(y,{type:"success",style:{"margin-bottom":"20px"},onClick:p.getMapDataList},{default:t(()=>e[9]||(e[9]=[i(" 刷新 ")])),_:1},8,["onClick"]),a(m,{modelValue:l.pageParams.keyword,"onUpdate:modelValue":e[0]||(e[0]=f=>l.pageParams.keyword=f),placeholder:"模糊搜索",onInput:p.getMapDataList,clearable:"","prefix-icon":"Search",style:{"margin-left":"20px",width:"400px","margin-bottom":"20px"}},null,8,["modelValue","onInput"]),a(y,{type:"primary",onClick:e[1]||(e[1]=f=>l.addMapData=!0),style:{"margin-left":"20px","margin-bottom":"20px"}},{default:t(()=>e[10]||(e[10]=[i(" 新增IP数据 ")])),_:1}),a(y,{type:"primary",onClick:p.updateOciCfgIpData,style:{"margin-left":"20px","margin-bottom":"20px"}},{default:t(()=>e[11]||(e[11]=[i(" 同步已有的oci配置最新数据 ")])),_:1},8,["onClick"]),a(y,{type:"danger",onClick:p.batchRemove,disabled:!l.batchSelected.length,style:{"margin-left":"20px","margin-bottom":"20px"}},{default:t(()=>e[12]||(e[12]=[i(" 批量删除 ")])),_:1},8,["onClick","disabled"]),n("div",Ye,[O((b(),U(D,{data:l.mapDataPageRsp,style:{width:"100%","min-width":"800px"},onSelectionChange:p.handleSelectionChange},{default:t(()=>[a(c,{type:"selection",width:"35"}),a(c,{label:"IP地址",width:"260"},{default:t(({row:f})=>[a(C,{content:f.ip,placement:"top"},{default:t(()=>[a(g,{type:"success",onClick:r=>p.copyToClipboard(f.ip)},{default:t(()=>[i(k(f.ip),1)]),_:2},1032,["onClick"])]),_:2},1032,["content"])]),_:1}),a(c,{label:"国家"},{default:t(({row:f})=>[a(C,{content:f.country,placement:"top"},{default:t(()=>[a(g,{type:"primary"},{default:t(()=>[i(k(f.country),1)]),_:2},1024)]),_:2},1032,["content"])]),_:1}),a(c,{label:"地区"},{default:t(({row:f})=>[a(C,{content:f.area,placement:"top"},{default:t(()=>[i(k(f.area),1)]),_:2},1032,["content"])]),_:1}),a(c,{label:"城市"},{default:t(({row:f})=>[a(C,{content:f.city,placement:"top"},{default:t(()=>[i(k(f.city),1)]),_:2},1032,["content"])]),_:1}),a(c,{label:"组织"},{default:t(({row:f})=>[a(C,{content:f.org,placement:"top"},{default:t(()=>[i(k(f.org),1)]),_:2},1032,["content"])]),_:1}),a(c,{label:"ASN"},{default:t(({row:f})=>[a(C,{content:f.asn,placement:"top"},{default:t(()=>[a(g,{type:"warning"},{default:t(()=>[i(k(f.asn),1)]),_:2},1024)]),_:2},1032,["content"])]),_:1}),a(c,{label:"纬度"},{default:t(({row:f})=>[a(C,{content:f.lat,placement:"top"},{default:t(()=>[a(g,{type:"primary"},{default:t(()=>[i(k(f.lat),1)]),_:2},1024)]),_:2},1032,["content"])]),_:1}),a(c,{label:"经度"},{default:t(({row:f})=>[a(C,{content:f.lng,placement:"top"},{default:t(()=>[a(g,{type:"primary"},{default:t(()=>[i(k(f.lng),1)]),_:2},1024)]),_:2},1032,["content"])]),_:1}),a(c,{label:"操作",width:"220"},{default:t(({row:f})=>[a(y,{onClick:r=>p.updateIpInfo(f),type:"success",link:""},{default:t(()=>e[13]||(e[13]=[i(" 更新IP信息 ")])),_:2},1032,["onClick"]),a(y,{onClick:r=>p.handleRemove(f),type:"danger",link:""},{default:t(()=>e[14]||(e[14]=[i(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSelectionChange"])),[[_,l.loading]])]),a(v,{onCurrentChange:p.handlePageChange,onSizeChange:p.handleSizeChange,"current-page":l.pageParams.currentPage,"onUpdate:currentPage":e[2]||(e[2]=f=>l.pageParams.currentPage=f),"page-size":l.pageParams.pageSize,"onUpdate:pageSize":e[3]||(e[3]=f=>l.pageParams.pageSize=f),"page-sizes":[5,10,20,50],total:l.total,layout:"total, sizes, prev, pager, next, jumper",style:{"margin-top":"20px"}},null,8,["onCurrentChange","onSizeChange","current-page","page-size","total"])]),a(w,{modelValue:l.addMapData,"onUpdate:modelValue":e[7]||(e[7]=f=>l.addMapData=f),title:"新增地图IP数据",width:"40%",onClose:e[8]||(e[8]=f=>l.addMapData=!1)},{footer:t(()=>[n("div",$e,[a(y,{type:"info",onClick:e[5]||(e[5]=f=>l.addMapData=!1)},{default:t(()=>e[15]||(e[15]=[i("取消")])),_:1}),a(y,{type:"primary",onClick:e[6]||(e[6]=f=>p.addIpData()),loading:l.addIpDataLoading},{default:t(()=>e[16]||(e[16]=[i("新增")])),_:1},8,["loading"])])]),default:t(()=>[a(P,{"label-width":"200px"},{default:t(()=>[a(I,{label:"IP地址（支持v4、v6）","label-width":"150px"},{default:t(()=>[a(m,{class:"cf-input",modelValue:l.addIpDataParams.ip,"onUpdate:modelValue":e[4]||(e[4]=f=>l.addIpDataParams.ip=f),placeholder:"请输入IP地址",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}const aa=B(Xe,[["render",ea]]),ta={data(){return{activeTab:"basicCfg"}},components:{BasicCfg:Ae,BackUp:ze,CloudflareCfg:Ze,IpDataView:te,MapData:aa}},la={class:"tab-content"},oa={key:0},sa={key:1},na={key:2},da={key:3},ia={key:4};function ra(o,e,S,A,l,p){const y=s("Setting"),m=s("el-icon"),c=s("el-tab-pane"),g=s("DocumentCopy"),C=s("MostlyCloudy"),D=s("Search"),v=s("MapLocation"),I=s("BasicCfg"),P=s("BackUp"),w=s("CloudflareCfg"),_=s("IpDataView"),f=s("MapData"),r=s("el-tabs");return b(),U(r,{type:"border-card",class:"demo-tabs",modelValue:l.activeTab,"onUpdate:modelValue":e[0]||(e[0]=R=>l.activeTab=R)},{default:t(()=>[a(c,{label:"basicCfg",name:"basicCfg"},{label:t(()=>[n("span",null,[a(m,null,{default:t(()=>[a(y)]),_:1}),e[1]||(e[1]=n("span",{style:{"margin-left":"5px"}},"基本设置",-1))])]),_:1}),a(c,{label:"backup",name:"backup"},{label:t(()=>[n("span",null,[a(m,null,{default:t(()=>[a(g)]),_:1}),e[2]||(e[2]=n("span",{style:{"margin-left":"5px"}},"备份恢复",-1))])]),_:1}),a(c,{label:"cfCfg",name:"cfCfg"},{label:t(()=>[n("span",null,[a(m,null,{default:t(()=>[a(C)]),_:1}),e[3]||(e[3]=n("span",{style:{"margin-left":"5px"}},"Cloudflare配置",-1))])]),_:1}),a(c,{label:"ipData",name:"ipData"},{label:t(()=>[n("span",null,[a(m,null,{default:t(()=>[a(D)]),_:1}),e[4]||(e[4]=n("span",{style:{"margin-left":"5px"}},"IP信息查询",-1))])]),_:1}),a(c,{label:"mapData",name:"mapData"},{label:t(()=>[n("span",null,[a(m,null,{default:t(()=>[a(v)]),_:1}),e[5]||(e[5]=n("span",{style:{"margin-left":"5px"}},"地图数据",-1))])]),_:1}),n("div",la,[l.activeTab==="basicCfg"?(b(),V("div",oa,[a(I)])):x("",!0),l.activeTab==="backup"?(b(),V("div",sa,[a(P)])):x("",!0),l.activeTab==="cfCfg"?(b(),V("div",na,[a(w)])):x("",!0),l.activeTab==="ipData"?(b(),V("div",da,[a(_)])):x("",!0),l.activeTab==="mapData"?(b(),V("div",ia,[a(f)])):x("",!0)])]),_:1},8,["modelValue"])}const ua=B(ta,[["render",ra]]);export{ua as default};
